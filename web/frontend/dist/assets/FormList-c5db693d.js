import{Q as ae,T as oe,R as $,j as s,bd as le,u as j,d as f,i as c,be as re,b as r,n as ce,o as y,bf as de,S as E,h as ue,F as b,bg as me,P as he,v as pe,l as be,V as M,N as L,X as R,bh as B,bi as O,bj as ge}from"./index-a7d8285a.js";import"./moment-a9aaa855.js";import{s as g}from"./FormStyle.module-55a0a2cc.js";/* empty css                              */import{u as fe}from"./useElements-2ff18ba1.js";import{C as Se}from"./index-282207c4.js";import{L as Te}from"./Link-72135556.js";import{a as Ee,b as Fe}from"./ResourceList-a6602479.js";import{S as ve}from"./Select-2f2ac977.js";import{S as Ne}from"./SkeletonDisplayText-c88dfc70.js";import"./index-f3e62e88.js";import"./Bleed-69b7a5e3.js";import"./Checkbox-61ccab64.js";import"./InlineError-95e8c5a5.js";import"./TickSmallMinor.svg-14eb6703.js";import"./SelectAllActions-7723543d.js";import"./Labelled-b978b66a.js";var V={SkeletonThumbnail:"Polaris-SkeletonThumbnail",sizeExtraSmall:"Polaris-SkeletonThumbnail--sizeExtraSmall",sizeSmall:"Polaris-SkeletonThumbnail--sizeSmall",sizeMedium:"Polaris-SkeletonThumbnail--sizeMedium",sizeLarge:"Polaris-SkeletonThumbnail--sizeLarge"};function D({size:a="medium"}){const d=ae(V.SkeletonThumbnail,a&&V[oe("size",a)]);return $.createElement("div",{className:d})}const Ce="/assets/noData-a3e8bfef.gif",_e=()=>s(le,{heading:"No form Data Found",image:Ce,children:s("p",{children:"Whoops.... this information is not available for a moment"})});const Ae=({items:a})=>{const d=j(),F=f(u=>u.shopId.shopId),S=(u,v)=>{d(re({shopId:F,_id:v,isVisible:u.target.checked}))};return s("div",{className:"ips-switch-container",children:c("div",{className:"ips-toggle-switch",children:[s("input",{type:"checkbox",checked:a.isVisible,className:"checkbox",name:"isvisible_switch",id:`isvisible_switch_${a._id}`,onChange:u=>S(u,a._id)}),c("label",{className:"label",htmlFor:`isvisible_switch_${a._id}`,children:[s("span",{className:"inner"}),s("span",{className:"switch"})]})]})})};function ye(){var x,P,z;const[a,d]=r.useState("DATE_MODIFIED_DESC"),[F,S]=r.useState([]),[u,v]=r.useState(!1),[U,I]=r.useState([]),X=ce.useAppBridge(),N=j(),k=y.Fullscreen.create(X),C=de(),{elements:Y}=fe(),[w,_]=r.useState(!1),m=f(e=>e.shopId.shopId),n=f(e=>{var o;return(o=e==null?void 0:e.inputField)==null?void 0:o.finalFormData}),Q=e=>{C("/submissions",{state:{id:e}})},W=e=>{var t,p;const o=(p=(t=n.formData)==null?void 0:t.filter)==null?void 0:p.call(t,T=>T._id===e),i=`<div class="form-builder-ips" data-ap-key='${m}' data-key='${o[0].isVisible?e:""}'></div>`;navigator.clipboard.writeText(i).then(function(){B.success("Code Coiped",O)},function(T){B.error(T,O)})},A=f(e=>e.user.userData.subscription),l=f(e=>e.user.userData.user),h=r.useMemo(()=>{var o;const e=(o=n==null?void 0:n.formData)==null?void 0:o.filter(i=>{var t;return(l==null?void 0:l.subscriptionName)===E.FREE&&((t=i==null?void 0:i.hasPremiumInput)==null?void 0:t.length)>0?null:(l.subscriptionName===E.PREMIUM,i)});switch(a){case"DATE_MODIFIED_DESC":return[...e].sort((i,t)=>new Date(t.createdAt).getTime()-new Date(i.createdAt).getTime());case"DATE_MODIFIED_ASC":return[...e].sort((i,t)=>new Date(i.createdAt).getTime()-new Date(t.createdAt).getTime());default:return e}},[n==null?void 0:n.formData,a]),H=e=>{let o=[];S(e),h.filter((i,t)=>e.filter((p,T)=>t==p).length===1).map(i=>o.push(i==null?void 0:i._id)),I(o)},q=e=>{d(e)},G=()=>{_(!0)},J=r.useCallback(()=>{_(!1)},[]),K=()=>{N(ge({deleteFormArr:U,shopId:m})),I([]),S([]),_(!1)},Z={singular:"form",plural:"forms"},ee=[{label:"Newest update",value:"DATE_MODIFIED_DESC"},{label:"Oldest update",value:"DATE_MODIFIED_ASC"}],se=[{content:"Delete form",onAction:()=>{G()}}],ne=()=>{k.dispatch(y.Fullscreen.Action.ENTER),v(!0),C("/form/new")};r.useEffect(()=>{N(ue(m)),k.dispatch(y.Fullscreen.Action.EXIT)},[N,m]);const te=(h==null?void 0:h.length)>=((P=(x=A==null?void 0:A.features)==null?void 0:x.form)==null?void 0:P.number_of_forms)&&(l==null?void 0:l.subscriptionName)===E.FREE;return c(b,{children:[(l==null?void 0:l.subscriptionName)===E.FREE?s("div",{className:g.ipsFormPreviewElementBanner,children:s(me,{title:c(b,{children:["You are in Free plan. You can create only 10 forms allowed in your plan. Upgrade to premium to create more forms."," ",s(Te,{url:"/plans",children:s("span",{className:g.premiumPlanLink,children:"Upgrade now."})})]})})}):null,c(he,{fullWidth:!0,title:"Forms",primaryAction:{content:"Create New Form",onAction:()=>ne(),disabled:!!te},children:[s(pe,{children:!m||((z=n==null?void 0:n.formData)==null?void 0:z.length)>0?s(Ee,{resourceName:Z,items:h,renderItem:ie,sortValue:a,selectedItems:F,onSelectionChange:H,promotedBulkActions:se,loading:!m||(n==null?void 0:n.loading),onSortChange:e=>d(e),selectable:!0,alternateTool:s(b,{children:s(ve,{label:"Sort by",labelInline:!0,options:ee,onChange:q,value:a})})}):s(_e,{})}),w&&s(Se,{active:w,handleClose:J,handleDelete:K,title:"Are you sure to delete selected form(s)?",description:"<p><strong>Note:</strong> Deleting this form will result in the removal of the following:</p>\r <ul>\r <li>The form and its contents.</li>\r <li>Submissions created for this form</li>\r <li>Associated API connections and logs.</li>\r </ul>\r <p>Be sure to Export any important data or files related to this form.</p>"}),s(be,{})]})]});function ie(e,o){var i;return e.customForm.map(t=>{t!=null&&t.element&&Y(l.subscriptionName,t.element,!0)}),s(Fe,{id:o,name:e==null?void 0:e._id,persistActions:!0,children:c("div",{style:{display:"flex",alignItems:"center"},children:[s("div",{className:g.resouceItemTd,style:{padding:"2rem"},onClick:()=>C(`/form/${e==null?void 0:e._id}`),children:n!=null&&n.loading?s(Ne,{size:"medium"}):s("div",{children:(i=e==null?void 0:e.customForm)==null?void 0:i.map((t,p)=>s("div",{children:t.formTitle}))})}),s("div",{children:n!=null&&n.loading?s(D,{size:"small"}):s(Ae,{items:e})}),s("div",{className:g.submissionBtn,onClick:()=>Q(e==null?void 0:e._id),children:n!=null&&n.loading?s(D,{size:"small"}):c(b,{children:[s(M,{plain:!0,icon:L.submission}),s("div",{style:{marginTop:"4px"},children:s(R,{variant:"headingXs",as:"h6",color:"subdued",children:"View Submission"})})]})}),s("div",{className:g.submissionBtn,onClick:()=>W(e==null?void 0:e._id),children:n!=null&&n.loading?s(D,{size:"small"}):c(b,{children:[s(M,{plain:!0,icon:L.copy}),s("div",{style:{marginTop:"5px"},children:s(R,{variant:"headingXs",as:"h6",color:"subdued",children:"Copy HTML code"})})]})})]})})}}const Ye=$.memo(ye);export{Ye as default};
