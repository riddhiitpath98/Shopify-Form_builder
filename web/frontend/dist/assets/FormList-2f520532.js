import{O as le,Q as re,v as j,j as s,bc as ce,u as W,b as f,e as c,bd as de,a as r,m as ue,n as D,be as me,S as F,d as pe,F as b,bf as he,P as be,q as ge,k as fe,U as B,K as O,W as R,bg as $,bh as V,bi as Se}from"./index-cdbbdef1.js";import"./moment-fbc5633a.js";import{s as g}from"./FormStyle.module-55a0a2cc.js";/* empty css                              */import{u as Fe}from"./useElements-11d18f8c.js";import{C as Te}from"./index-8f8c825c.js";import{L as Ee}from"./Link-aaa92430.js";import{a as ve,b as Ne}from"./ResourceList-2508f881.js";import{S as Ce}from"./Select-a4816d0f.js";import{S as _e}from"./SkeletonDisplayText-e917a0cf.js";import"./index-f1ff8313.js";import"./Bleed-a317419e.js";import"./Checkbox-a1799219.js";import"./InlineError-fe270c03.js";import"./TickSmallMinor.svg-3b3bc779.js";import"./SelectAllActions-c4a9dcba.js";import"./Labelled-c5d2484a.js";var U={SkeletonThumbnail:"Polaris-SkeletonThumbnail",sizeExtraSmall:"Polaris-SkeletonThumbnail--sizeExtraSmall",sizeSmall:"Polaris-SkeletonThumbnail--sizeSmall",sizeMedium:"Polaris-SkeletonThumbnail--sizeMedium",sizeLarge:"Polaris-SkeletonThumbnail--sizeLarge"};function I({size:o="medium"}){const d=le(U.SkeletonThumbnail,o&&U[re("size",o)]);return j.createElement("div",{className:d})}const Ae="/assets/noData-a3e8bfef.gif",ye=()=>s(ce,{heading:"No form Data Found",image:Ae,children:s("p",{children:"Whoops.... this information is not available for a moment"})});const De=({items:o})=>{const d=W(),T=f(u=>u.shopId.shopId),S=(u,E)=>{d(de({shopId:T,_id:E,isVisible:u.target.checked}))};return s("div",{className:"ips-switch-container",children:c("div",{className:"ips-toggle-switch",children:[s("input",{type:"checkbox",checked:o.isVisible,className:"checkbox",name:"isvisible_switch",id:`isvisible_switch_${o._id}`,onChange:u=>S(u,o._id)}),c("label",{className:"label",htmlFor:`isvisible_switch_${o._id}`,children:[s("span",{className:"inner"}),s("span",{className:"switch"})]})]})})};function Ie(){var P,z,M;const[o,d]=r.useState("DATE_MODIFIED_DESC"),[T,S]=r.useState([]),[u,E]=r.useState(!1),[X,k]=r.useState([]),Y=ue.useAppBridge(),v=W(),w=D.Fullscreen.create(Y),N=me(),{elements:Q}=Fe(),[x,C]=r.useState(!1),m=f(e=>e.shopId.shopId),n=f(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.finalFormData}),q=e=>{N("/submissions",{state:{id:e}})},H=e=>{var t,h,A,L;const a=(h=(t=n.formData)==null?void 0:t.filter)==null?void 0:h.call(t,y=>y._id===e),i=`<div class="form-builder-ips" form-name='${(L=(A=a[0])==null?void 0:A.customForm[0])==null?void 0:L.formTitle}' data-ap-key='${m}' data-key='${a[0].isVisible?e:""}'></div>`;navigator.clipboard.writeText(i).then(function(){$.success("Code Coiped",V)},function(y){$.error(y,V)})},_=f(e=>e.user.userData.subscription),l=f(e=>e.user.userData.user),p=r.useMemo(()=>{var a;const e=(a=n==null?void 0:n.formData)==null?void 0:a.filter(i=>{var t;return(l==null?void 0:l.subscriptionName)===F.FREE&&((t=i==null?void 0:i.hasPremiumInput)==null?void 0:t.length)>0?null:(l.subscriptionName===F.PREMIUM,i)});switch(o){case"DATE_MODIFIED_DESC":return[...e].sort((i,t)=>new Date(t.createdAt).getTime()-new Date(i.createdAt).getTime());case"DATE_MODIFIED_ASC":return[...e].sort((i,t)=>new Date(i.createdAt).getTime()-new Date(t.createdAt).getTime());default:return e}},[n==null?void 0:n.formData,o]),K=e=>{let a=[];S(e),p.filter((i,t)=>e.filter((h,A)=>t==h).length===1).map(i=>a.push(i==null?void 0:i._id)),k(a)},G=e=>{d(e)},J=()=>{C(!0)},Z=r.useCallback(()=>{C(!1)},[]),ee=()=>{v(Se({deleteFormArr:X,shopId:m})),k([]),S([]),C(!1)},se={singular:"form",plural:"forms"},ne=[{label:"Newest update",value:"DATE_MODIFIED_DESC"},{label:"Oldest update",value:"DATE_MODIFIED_ASC"}],te=[{content:"Delete form",onAction:()=>{J()}}],ie=()=>{w.dispatch(D.Fullscreen.Action.ENTER),E(!0),N("/form/new")};r.useEffect(()=>{v(pe(m)),w.dispatch(D.Fullscreen.Action.EXIT)},[v,m]);const ae=(p==null?void 0:p.length)>=((z=(P=_==null?void 0:_.features)==null?void 0:P.form)==null?void 0:z.number_of_forms)&&(l==null?void 0:l.subscriptionName)===F.FREE;return c(b,{children:[(l==null?void 0:l.subscriptionName)===F.FREE?s("div",{className:g.ipsFormPreviewElementBanner,children:s(he,{title:c(b,{children:["You are in Free plan. You can create only 10 forms allowed in your plan. Upgrade to premium to create more forms."," ",s(Ee,{url:"/plans",children:s("span",{className:g.premiumPlanLink,children:"Upgrade now."})})]})})}):null,c(be,{fullWidth:!0,title:"Forms",primaryAction:{content:"Create New Form",onAction:()=>ie(),disabled:!!ae},children:[s(ge,{children:!m||((M=n==null?void 0:n.formData)==null?void 0:M.length)>0?s(ve,{resourceName:se,items:p,renderItem:oe,sortValue:o,selectedItems:T,onSelectionChange:K,promotedBulkActions:te,loading:!m||(n==null?void 0:n.loading),onSortChange:e=>d(e),selectable:!0,alternateTool:s(b,{children:s(Ce,{label:"Sort by",labelInline:!0,options:ne,onChange:G,value:o})})}):s(ye,{})}),x&&s(Te,{active:x,handleClose:Z,handleDelete:ee,title:"Are you sure to delete selected form(s)?",description:"<p><strong>Note:</strong> Deleting this form will result in the removal of the following:</p>\r <ul>\r <li>The form and its contents.</li>\r <li>Submissions created for this form</li>\r <li>Associated API connections and logs.</li>\r </ul>\r <p>Be sure to Export any important data or files related to this form.</p>"}),s(fe,{})]})]});function oe(e,a){var i;return e.customForm.map(t=>{t!=null&&t.element&&Q(l.subscriptionName,t.element,!0)}),s(Ne,{id:a,name:e==null?void 0:e._id,persistActions:!0,children:c("div",{style:{display:"flex",alignItems:"center"},children:[s("div",{className:g.resouceItemTd,style:{padding:"2rem"},onClick:()=>N(`/form/${e==null?void 0:e._id}`),children:n!=null&&n.loading?s(_e,{size:"medium"}):s("div",{children:(i=e==null?void 0:e.customForm)==null?void 0:i.map((t,h)=>s("div",{children:t.formTitle}))})}),s("div",{children:n!=null&&n.loading?s(I,{size:"small"}):s(De,{items:e})}),s("div",{className:g.submissionBtn,onClick:()=>q(e==null?void 0:e._id),children:n!=null&&n.loading?s(I,{size:"small"}):c(b,{children:[s(B,{plain:!0,icon:O.submission}),s("div",{style:{marginTop:"4px"},children:s(R,{variant:"headingXs",as:"h6",color:"subdued",children:"View Submission"})})]})}),s("div",{className:g.submissionBtn,onClick:()=>H(e==null?void 0:e._id),children:n!=null&&n.loading?s(I,{size:"small"}):c(b,{children:[s(B,{plain:!0,icon:O.copy}),s("div",{style:{marginTop:"5px"},children:s(R,{variant:"headingXs",as:"h6",color:"subdued",children:"Copy HTML code"})})]})})]})})}}const Qe=j.memo(Ie);export{Qe as default};
