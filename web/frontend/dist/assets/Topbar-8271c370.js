import{R as G,u as H,b as m,n as K,o as W,bd as Y,bj as q,d as i,cc as z,S as J,bw as Q,bx as X,j as t,i as p,K as b,N as S,aP as Z,V as v,bv as ee,cd as ae,ce as te,cf as ie,cg as oe,ch as re}from"./index-c3d5bec4.js";import{s as o}from"./FormStyle.module-55a0a2cc.js";/* empty css                              */import{L as x}from"./Link-50d247fa.js";import{T as ce}from"./TextField-5e3ff95c.js";import"./Labelled-61d21849.js";import"./InlineError-24c0ced4.js";const le=({handleRedirectToForm:u})=>{var V;const c=H(),[n,g]=m.useState({title:"New Form"}),j=K.useAppBridge();W.Fullscreen.create(j),Y();const{editFormId:s}=q(),M=i(e=>e.shopId.shopId),N=i(e=>{var a;return(a=e.viewPort)==null?void 0:a.selectedViewport}),U=i(e=>e.formSetting.validationData.data.validation),O=i(e=>e.formSetting.appearanceData.data.appearance),$=i(e=>e.formSetting.afterSubmitData.data.afterSubmit),D=i(e=>{var a;return(a=e.formSetting.validationData)==null?void 0:a.updatedValidation}),F=i(e=>{var a;return(a=e.formSetting.appearanceData)==null?void 0:a.updatedAppearance}),k=i(e=>{var a;return(a=e.formSetting.afterSubmitData)==null?void 0:a.updatedAfterSubmit}),r=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.inputFields}),I=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.headerFieldData}),w=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.footerFieldData}),A=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.allElementData}),l=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.finalFormData}),C=i(e=>{var a;return(a=e.inputField)==null?void 0:a.isSaveOrUpdate}),y=i(e=>{var a,d,B;return(B=(d=(a=e==null?void 0:e.inputField)==null?void 0:a.editFormData)==null?void 0:d.formData)==null?void 0:B.customForm}),f=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.googelRecaptcha}),h=(V=z(y))==null?void 0:V.formTitle;i(e=>e.user.userData.user);const R=(e,a)=>{g({[e]:a})},T=e=>{c(ee(e))},E=m.useMemo(()=>{let e=[];return r.map(a=>{var d;(d=a==null?void 0:a.viewAccess)!=null&&d.includes(J.PREMIUM)&&(e=[...e,a.id])}),e},[r]),P=m.useMemo(()=>{let e=[];return r.map(a=>{a!=null&&a.viewAccess||(e=[...e,a.id])}),e},[r]),L=()=>{const e={shopId:M,hasPremiumInput:E,hasFreeInput:P,enableReCaptcha:(f==null?void 0:f.enable)||!1,customForm:[{formTitle:n.title},{header:I},{element:r},{allElements:A},{footer:w}]};c(ae({combinedObjectArr:e,updatedErrorMsg:D,updatedAppearance:F,updatedAfterSubmit:k}))},_=()=>{const e=[{formTitle:n.title},{header:I},{element:r},{allElements:A},{footer:w}];c(te({_id:s,combinedObjectArr:{customForm:e,hasFreeInput:P,hasPremiumInput:E}})),c(ie({formId:s,validationData:D||U})),c(oe({formId:s,appearanceData:F||O})),c(re({formId:s,afterSubmitData:k||$}))};return m.useEffect(()=>{C&&(c(Q(!1)),c(X(!1)))},[C]),m.useEffect(()=>{h&&g({title:h})},[h]),t("div",{children:p("div",{className:o.topBar,children:[p("div",{className:o.sideBar,children:[t("div",{className:o.logo,onClick:u,children:t(x,{url:"/form",children:t(b,{source:S.backArrow,className:o.leftIcon})})}),t("div",{className:o.backTitle,onClick:u,children:t(x,{url:"/form",children:t("span",{children:"Back to List"})})})]}),t("div",{className:o.rightContext,children:p("div",{className:o.innerContext,children:[t("div",{className:o.formNameWrapper,children:t(ce,{labelHidden:!0,name:"title",placeholder:"Enter Form Name",value:n==null?void 0:n.title,onChange:e=>R("title",e)})}),t("div",{className:o.itemViewPort,children:p("ul",{className:o.viewPortSelector,children:[t("li",{className:`${o.mobileView} ${N==="mobile"?o.ipsTabActive:""}`,onClick:()=>T("mobile"),children:t(b,{source:S.mobile})}),t("li",{className:`${o.desktopView} ${N==="desktop"?o.ipsTabActive:""}`,onClick:()=>T("desktop"),children:t(b,{source:S.desktop})})]})}),t("div",{className:o.itemAction,children:p(Z,{children:[t(v,{onClick:u,children:"Cancel"}),s?t(v,{primary:!0,onClick:_,loading:l==null?void 0:l.loading,disabled:(r==null?void 0:r.length)===0,children:"Update"}):t(v,{primary:!0,onClick:L,loading:l==null?void 0:l.loading,disabled:(r==null?void 0:r.length)===0,children:"Save"})]})})]})})]})})},he=G.memo(le);export{he as default};
