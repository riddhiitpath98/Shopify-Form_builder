import{a as i,_ as se,u as le,b9 as re,be as ne,b as A,d as te,bt as ie,e as q,P as ue,j as l,i as K,p as ce,T as ae,I as de,G as pe,O as z,k as H,bu as me,ac as he,bv as fe,bw as be}from"./index-02b1340d.js";import{F as Ce}from"./Form-420edd8d.js";import{F as Te,G as c}from"./Grid-8ddc78f4.js";import{T as x}from"./TextField-2ed41e1b.js";import{S as $}from"./Select-dc287e62.js";import"./Labelled-34a75db8.js";import"./InlineError-dd1cf19e.js";const Ie="_ipsContactusLayoutContainer_130n3_1",Ae="_ipsContactusSubmissions_130n3_25",Pe="_ipsAPIMapFeildContainer_130n3_37",_e="_ipsAPISupportIcon_130n3_47",E={ipsContactusLayoutContainer:Ie,ipsContactusSubmissions:Ae,ipsAPIMapFeildContainer:Pe,ipsAPISupportIcon:_e},Fe=i.lazy(()=>se(()=>import("./index-96c5d500.js"),["assets/index-96c5d500.js","assets/index-02b1340d.js","assets/index-ac84de1a.css","assets/index-f5d766a6.css"])),Me=({isEdit:P})=>{const h=le(),y=re(),[d,U]=i.useState([]),[f,b]=i.useState({}),[S,k]=i.useState(!1),[v,V]=i.useState({}),{apiId:a}=ne(),[t,C]=i.useState({apiTitle:"",apiUrl:"",headerRequest:"",inputType:"",method:"",formId:"",shopId:""}),W=()=>{k(!0)},J=()=>{k(!1)},[T,_]=i.useState({}),w=A(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.apiSettingData}),M=A(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.allApiSettingData}),s=A(e=>{var o,r;return(r=(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.editAPISettingsData)==null?void 0:r.data}),O=A(e=>e.shopId.shopId),p=A(e=>{var o,r;return(r=(o=e==null?void 0:e.inputField)==null?void 0:o.finalFormData)==null?void 0:r.formData}),n=A(e=>{var o,r;return(r=(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.editAPISettingsDataByFormId)==null?void 0:r.data}),[ve,R]=i.useState(!1),L=e=>{const o=p.find(r=>r._id===e);if(o){const r=o.customForm.find(u=>u.element);if(r)return r.element}return null};i.useEffect(()=>{h(te(O))},[h,O]),i.useEffect(()=>{P&&a&&h(ie(a))},[P,a]),i.useEffect(()=>{if(P&&a){C({apiTitle:s==null?void 0:s.apiTitle,apiUrl:s==null?void 0:s.apiUrl,headerRequest:s==null?void 0:s.headerRequest,inputType:s==null?void 0:s.inputType,method:s==null?void 0:s.method,formId:s==null?void 0:s.form,shopId:s==null?void 0:s.shopId});const e=L(s==null?void 0:s.form);e&&(U(e),b({...s==null?void 0:s.elementKey}))}},[P,a,s]),i.useEffect(()=>{C({...t,shopId:O,elementKey:f})},[f]);const j=(e,o)=>!e||!o?"This field is required.":"",m=(e,o,r=!1)=>{let u={};if(u={...t,[e]:o},e==="formId"){const F=o;if(a){if(h(me(F)),Object.keys(n).length>0){C({apiTitle:n==null?void 0:n.apiTitle,apiUrl:n==null?void 0:n.apiUrl,headerRequest:n==null?void 0:n.headerRequest,inputType:n==null?void 0:n.inputType,method:n==null?void 0:n.method,formId:n==null?void 0:n.form,shopId:n==null?void 0:n.shopId});const I=L(s==null?void 0:s.form);I&&(U(I),b({...s==null?void 0:s.elementKey}))}}else{const I=L(F);if(I){U(I);let G={};I.forEach(g=>{G[`${g==null?void 0:g.inputId}_${g.id}`]=""}),b({...G})}}}r||_(he(u)),!r&&C({...t,[e]:o}),r&&b({...f,[e]:o}),r&&V({...v,[e]:j(e,o)})},N=[],Q=i.useMemo(()=>(p==null||p.map(e=>{var o;(o=e==null?void 0:e.customForm)==null||o.forEach(r=>{r.formTitle&&N.push({id:e._id,title:r.formTitle})})}),N),[p==null?void 0:p.length]),X=[{label:"Select Form",value:"",disabled:!0},...Q.map(e=>({label:e.title,value:e.id}))],Y=[{label:"Select Type",value:"",disabled:!0},{label:"json",value:"json"}],Z=[{label:"Select Method",value:"",disabled:!0},{label:"GET",value:"get"},{label:"POST",value:"post"}],D=async e=>{let o={},r={...f,...t};if(Object.keys(r).forEach(u=>{const F=j(u,r[u]);F&&(o[u]=F)}),Object.keys(o).length){V({...o,...v}),_({...o});return}h(fe(t)),C({}),b({}),_({}),R(!1),y("/api-settings")},B=()=>{let e={},o={...f,...t};if(Object.keys(o).forEach(r=>{const u=j(r,o[r]);u&&(e[r]=u)}),Object.keys(e).length){V({...e,...v}),_({...e});return}h(be({id:a,formValues:t})),C({}),b({}),_({}),R(!1),y("/api-settings")},ee=()=>{R(!1),y("/api-settings")},oe=e=>{P&&a?B():D()};return q(ue,{fullWidth:!0,title:"Add New Contact Form API",primaryAction:{content:"View API List",onAction:()=>ee()},children:[l("div",{children:l(K,{children:l(K.Section,{children:l("div",{className:E.ipsContactusFormLayoutContainer,children:l(ce,{sectioned:!0,children:q(Ce,{onSubmit:e=>oe(),noValidate:!0,children:[l(Te,{children:q(c,{children:[l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:l(x,{value:t.apiTitle||"",name:"apiUrl",onChange:e=>m("apiTitle",e),label:"Add API title",type:"text",requiredIndicator:!0,error:T.apiTitle,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l($,{label:"Select Contact Form",name:"formId",options:X,onChange:e=>m("formId",e),value:t.formId||"",error:T.formId})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:t.apiUrl||"",name:"apiUrl",onChange:e=>m("apiUrl",e),label:"API Url",type:"text",requiredIndicator:!0,error:T.apiUrl,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:t.headerRequest||"",name:"headerRequest",onChange:e=>m("headerRequest",e),label:"Header Request",type:"headerRequest",multiline:5,requiredIndicator:!0,error:T.headerRequest,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l($,{label:"Input Type",name:"inputType",options:Y,onChange:e=>m("inputType",e),value:t.inputType||"",error:T.inputType})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:l($,{label:"Method",name:"method",options:Z,onChange:e=>m("method",e),value:t.method||"",error:T.method})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:q("div",{className:E.ipsAPIMapFeildContainer,children:[l(ae,{children:"Map your Fields"}),l("div",{className:E.ipsAPISupportIcon,onMouseEnter:W,children:l(de,{source:pe.support,color:"base"})})]})}),d&&(d==null?void 0:d.length)>0?d==null?void 0:d.map(e=>l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:f[`${e.inputId}_${e.id}`]||"",name:`${e.inputId}_${e.id}`,onChange:o=>m(`${e.inputId}_${e.id}`,o,!0),label:e.attributes.label,type:"text",placeholder:"Enter mapping key field name",requiredIndicator:!0,autoComplete:"off",error:v[`${e.inputId}_${e.id}`]})})):null,l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:a?l(z,{primary:!0,submit:!0,loading:M==null?void 0:M.loading,children:"Update"}):l(z,{primary:!0,submit:!0,loading:w==null?void 0:w.loading,children:"Save"})})]})}),l(H,{})]})})})})})}),S&&l(Fe,{open:S,handleClose:J,src:"https://www.contactformtoapi.com/mapping-fields/",title:"Mapping Fields",width:"1000",height:"1000"}),l(H,{})]})};export{Me as default};
