import{b as l,c as oe,u as se,bd as te,bj as re,d as g,h as ne,by as le,i as P,P as ie,j as s,L as G,v as ae,X as ce,K as ue,N as de,V as K,l as z,ag as pe,ba as me,bz as he}from"./index-c3d5bec4.js";import{F as fe}from"./Form-9ac7007b.js";import{F as Ie,G as a}from"./Grid-f89933cc.js";import{T as _}from"./TextField-5e3ff95c.js";import{S as U}from"./Select-b61b0b8e.js";import"./Labelled-61d21849.js";import"./InlineError-24c0ced4.js";const Ce="_ipsContactusLayoutContainer_130n3_1",be="_ipsContactusSubmissions_130n3_25",Fe="_ipsAPIMapFeildContainer_130n3_37",ge="_ipsAPISupportIcon_130n3_47",j={ipsContactusLayoutContainer:Ce,ipsContactusSubmissions:be,ipsAPIMapFeildContainer:Fe,ipsAPISupportIcon:ge},Te=l.lazy(()=>oe(()=>import("./index-3fd386e5.js"),["assets/index-3fd386e5.js","assets/index-c3d5bec4.js","assets/index-ac84de1a.css","assets/index-f5d766a6.css"])),Ve=({isEdit:f})=>{const I=se(),y=te(),[u,O]=l.useState([]),[m,C]=l.useState({}),[R,$]=l.useState(!1),[T,S]=l.useState({}),{apiId:c}=re(),[n,b]=l.useState({apiTitle:"",apiUrl:"",headerRequest:"",inputType:"",method:"",formId:"",shopId:""}),H=()=>{$(!0)},W=()=>{$(!1)},[h,F]=l.useState({}),v=g(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.apiSettingData}),x=g(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.allApiSettingData}),t=g(e=>{var o,r;return(r=(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.editAPISettingsData)==null?void 0:r.data}),q=g(e=>e.shopId.shopId),d=g(e=>{var o,r;return(r=(o=e==null?void 0:e.inputField)==null?void 0:o.finalFormData)==null?void 0:r.formData}),[Ae,V]=l.useState(!1),E=e=>{const o=d.find(r=>r._id===e);if(o){const r=o.customForm.find(i=>i.element);if(r)return r.element}return null};l.useEffect(()=>{I(ne(q))},[I,q]),l.useEffect(()=>{f&&c&&I(le(c))},[f,c]),l.useEffect(()=>{if(f&&c){b({apiTitle:t==null?void 0:t.apiTitle,apiUrl:t==null?void 0:t.apiUrl,headerRequest:t==null?void 0:t.headerRequest,inputType:t==null?void 0:t.inputType,method:t==null?void 0:t.method,formId:t==null?void 0:t.form,shopId:t==null?void 0:t.shopId});const e=E(t==null?void 0:t.form);e&&(O(e),C({...t==null?void 0:t.elementKey}))}},[f,c,t]),l.useEffect(()=>{b({...n,shopId:q,elementKey:m})},[m]);const L=(e,o)=>!e||!o?"This field is required.":"",p=(e,o,r=!1)=>{let i={};if(i={...n,[e]:o},e==="formId"){const w=E(o);if(w){O(w);let N={};w.forEach(A=>{N[`${A==null?void 0:A.inputId}_${A.id}`]=""}),C({...N})}}r||F(pe(i)),!r&&b({...n,[e]:o}),r&&C({...m,[e]:o}),r&&S({...T,[e]:L(e,o)})},k=[],X=l.useMemo(()=>(d==null||d.map(e=>{var o;(o=e==null?void 0:e.customForm)==null||o.forEach(r=>{r.formTitle&&k.push({id:e._id,title:r.formTitle})})}),k),[d==null?void 0:d.length]),J=[{label:"Select Form",value:"",disabled:!0},...X.map(e=>({label:e.title,value:e.id}))],Q=[{label:"Select Type",value:"",disabled:!0},{label:"json",value:"json"}],Y=[{label:"Select Method",value:"",disabled:!0},{label:"GET",value:"get"},{label:"POST",value:"post"}],Z=async e=>{let o={},r={...m,...n};if(Object.keys(r).forEach(i=>{const M=L(i,r[i]);M&&(o[i]=M)}),Object.keys(o).length){S({...o,...T}),F({...o});return}I(me(n)),b({}),C({}),F({}),V(!1),y("/api-settings")},D=()=>{let e={},o={...m,...n};if(Object.keys(o).forEach(r=>{const i=L(r,o[r]);i&&(e[r]=i)}),Object.keys(e).length){S({...e,...T}),F({...e});return}I(he({id:c,formValues:n})),b({}),C({}),F({}),V(!1),y("/api-settings")},B=()=>{V(!1),y("/api-settings")},ee=e=>{f&&c?D():Z()};return P(ie,{fullWidth:!0,title:"Add New Contact Form API",primaryAction:{content:"View API List",onAction:()=>B()},children:[s("div",{children:s(G,{children:s(G.Section,{children:s("div",{className:j.ipsContactusFormLayoutContainer,children:s(ae,{sectioned:!0,children:P(fe,{onSubmit:e=>ee(),noValidate:!0,children:[s(Ie,{children:P(a,{children:[s(a.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:s(_,{value:n.apiTitle||"",name:"apiUrl",onChange:e=>p("apiTitle",e),label:"Add API title",type:"text",requiredIndicator:!0,error:h.apiTitle,autoComplete:"off"})}),s(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:s(U,{label:"Select Contact Form",name:"formId",options:J,onChange:e=>p("formId",e),value:n.formId||"",error:h.formId})}),s(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:s(_,{value:n.apiUrl||"",name:"apiUrl",onChange:e=>p("apiUrl",e),label:"API Url",type:"text",requiredIndicator:!0,error:h.apiUrl,autoComplete:"off"})}),s(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:s(_,{value:n.headerRequest||"",name:"headerRequest",onChange:e=>p("headerRequest",e),label:"Header Request",type:"headerRequest",multiline:5,requiredIndicator:!0,error:h.headerRequest,autoComplete:"off"})}),s(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:s(U,{label:"Input Type",name:"inputType",options:Q,onChange:e=>p("inputType",e),value:n.inputType||"",error:h.inputType})}),s(a.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:s(U,{label:"Method",name:"method",options:Y,onChange:e=>p("method",e),value:n.method||"",error:h.method})}),s(a.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:P("div",{className:j.ipsAPIMapFeildContainer,children:[s(ce,{children:"Map your Fields"}),s("div",{className:j.ipsAPISupportIcon,onMouseEnter:H,children:s(ue,{source:de.support,color:"base"})})]})}),u&&(u==null?void 0:u.length)>0?u==null?void 0:u.map(e=>s(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:s(_,{value:m[`${e.inputId}_${e.id}`]||"",name:`${e.inputId}_${e.id}`,onChange:o=>p(`${e.inputId}_${e.id}`,o,!0),label:e.attributes.label,type:"text",placeholder:"Enter mapping key field name",requiredIndicator:!0,autoComplete:"off",error:T[`${e.inputId}_${e.id}`]})})):null,s(a.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:c?s(K,{primary:!0,submit:!0,loading:x==null?void 0:x.loading,children:"Update"}):s(K,{primary:!0,submit:!0,loading:v==null?void 0:v.loading,children:"Save"})})]})}),s(z,{})]})})})})})}),R&&s(Te,{open:R,handleClose:W,src:"https://www.contactformtoapi.com/mapping-fields/",title:"Mapping Fields",width:"1000",height:"1000"}),s(z,{})]})};export{Ve as default};
