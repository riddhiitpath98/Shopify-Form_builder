import{J as oe,K as re,t as B,a as l,_ as E,l as le,u as ae,m as A,b9 as ie,b as f,S as _,d as ce,e as d,F as p,j as t,P as de,p as ue,k as me,O as x,G as z,T as L,ba as O,bb as R,bc as pe}from"./index-885978b8.js";import"./moment-fbc5633a.js";import{s as h}from"./FormStyle.module-55a0a2cc.js";/* empty css                              */import{u as he}from"./useElements-bed83891.js";import{L as ge}from"./Link-376dd265.js";import{a as Se,b as fe}from"./ResourceList-4f659ea7.js";import{S as _e}from"./Select-6d584da8.js";import{S as Ee}from"./SkeletonDisplayText-ea625194.js";import"./index-5bc7bc63.js";import"./Bleed-ed4f71d1.js";import"./Checkbox-c617239d.js";import"./InlineError-71d6bf79.js";import"./TickSmallMinor.svg-d264ec46.js";import"./SelectAllActions-1ff4a4a3.js";import"./Labelled-5b2a4701.js";var M={SkeletonThumbnail:"Polaris-SkeletonThumbnail",sizeExtraSmall:"Polaris-SkeletonThumbnail--sizeExtraSmall",sizeSmall:"Polaris-SkeletonThumbnail--sizeSmall",sizeMedium:"Polaris-SkeletonThumbnail--sizeMedium",sizeLarge:"Polaris-SkeletonThumbnail--sizeLarge"};function y({size:i="medium"}){const g=oe(M.SkeletonThumbnail,i&&M[re("size",i)]);return B.createElement("div",{className:g})}const be=l.lazy(()=>E(()=>import("./index-75819584.js"),["assets/index-75819584.js","assets/index-885978b8.js","assets/index-ac84de1a.css"])),Te=l.lazy(()=>E(()=>import("./index-885978b8.js").then(i=>i.cg),["assets/index-885978b8.js","assets/index-ac84de1a.css"])),Fe=l.lazy(()=>E(()=>import("./index-a2b7aeea.js"),["assets/index-a2b7aeea.js","assets/index-885978b8.js","assets/index-ac84de1a.css"])),ve=l.lazy(()=>E(()=>import("./index-1f95aa81.js"),["assets/index-1f95aa81.js","assets/index-885978b8.js","assets/index-ac84de1a.css","assets/index-c45666dd.css"]));function Ae(){var k,P,w;const[i,g]=l.useState("DATE_MODIFIED_DESC"),[V,C]=l.useState([]),[ye,$]=l.useState(!1),[U,D]=l.useState([]),j=le.useAppBridge(),b=ae(),I=A.Fullscreen.create(j),T=ie(),{elements:X}=he(),[N,F]=l.useState(!1),c=f(e=>e.shopId.shopId),n=f(e=>{var r;return(r=e==null?void 0:e.inputField)==null?void 0:r.finalFormData}),Y=e=>{T("/submissions",{state:{id:e}})},G=e=>{var s,m;const r=(m=(s=n.formData)==null?void 0:s.filter)==null?void 0:m.call(s,S=>S._id===e),o=`<div class="form-builder-ips" data-ap-key='${c}' data-key='${r[0].isVisible?e:""}'></div>`;navigator.clipboard.writeText(o).then(function(){O.success("Code Coiped",R)},function(S){O.error(S,R)})},v=f(e=>e.user.userData.subscription),a=f(e=>e.user.userData.user),u=l.useMemo(()=>{var r;const e=(r=n==null?void 0:n.formData)==null?void 0:r.filter(o=>{var s;return(a==null?void 0:a.subscriptionName)===_.FREE&&((s=o==null?void 0:o.hasPremiumInput)==null?void 0:s.length)>0?null:(a.subscriptionName===_.PREMIUM,o)});switch(i){case"DATE_MODIFIED_DESC":return[...e].sort((o,s)=>new Date(s.createdAt).getTime()-new Date(o.createdAt).getTime());case"DATE_MODIFIED_ASC":return[...e].sort((o,s)=>new Date(o.createdAt).getTime()-new Date(s.createdAt).getTime());default:return e}},[n==null?void 0:n.formData,i]),H=e=>{let r=[];C(e),u.filter((o,s)=>e.filter((m,S)=>s==m).length===1).map(o=>r.push(o==null?void 0:o._id)),D(r)},J=e=>{g(e)},K=()=>{F(!0)},Q=l.useCallback(()=>{F(!1)},[]),W=()=>{b(pe({deleteFormArr:U,shopId:c})),D([]),C([]),F(!1)},q={singular:"form",plural:"forms"},Z=[{label:"Newest update",value:"DATE_MODIFIED_DESC"},{label:"Oldest update",value:"DATE_MODIFIED_ASC"}],ee=[{content:"Delete form",onAction:()=>{K()}}],te=()=>{I.dispatch(A.Fullscreen.Action.ENTER),$(!0),T("/form/new")};l.useEffect(()=>{b(ce(c)),I.dispatch(A.Fullscreen.Action.EXIT)},[b,c]);const ne=(u==null?void 0:u.length)>=((P=(k=v==null?void 0:v.features)==null?void 0:k.form)==null?void 0:P.number_of_forms)&&(a==null?void 0:a.subscriptionName)===_.FREE;return d(p,{children:[(a==null?void 0:a.subscriptionName)===_.FREE?t("div",{className:h.ipsFormPreviewElementBanner,children:t(Te,{title:d(p,{children:["You are in Free plan. You can create only 10 forms allowed in your plan. Upgrade to premium to create more forms."," ",t(ge,{url:"/plans",children:t("span",{className:h.premiumPlanLink,children:"Upgrade now."})})]})})}):null,d(de,{fullWidth:!0,title:"Forms",primaryAction:{content:"Create New Form",onAction:()=>te(),disabled:!!ne},children:[t(ue,{children:!c||((w=n==null?void 0:n.formData)==null?void 0:w.length)>0?t(Se,{resourceName:q,items:u,renderItem:se,sortValue:i,selectedItems:V,onSelectionChange:H,promotedBulkActions:ee,loading:!c||(n==null?void 0:n.loading),onSortChange:e=>g(e),selectable:!0,alternateTool:t(p,{children:t(_e,{label:"Sort by",labelInline:!0,options:Z,onChange:J,value:i})})}):t(Fe,{})}),N&&t(be,{active:N,handleClose:Q,handleDelete:W,title:"Are you sure to delete selected form(s)?",description:"<p><strong>Note:</strong> Deleting this form will result in the removal of the following:</p>\r <ul>\r <li>The form and its contents.</li>\r <li>API and Logs created for this form.</li>\r </ul>\r <p>Be sure to Export any important data or files related to this form.</p>"}),t(me,{})]})]});function se(e,r){var o;return e.customForm.map(s=>{s!=null&&s.element&&X(a.subscriptionName,s.element,!0)}),t(fe,{id:r,name:e==null?void 0:e._id,persistActions:!0,children:d("div",{style:{display:"flex",alignItems:"center"},children:[t("div",{className:h.resouceItemTd,style:{padding:"2rem"},onClick:()=>T(`/form/${e==null?void 0:e._id}`),children:n!=null&&n.loading?t(Ee,{size:"medium"}):t("div",{children:(o=e==null?void 0:e.customForm)==null?void 0:o.map((s,m)=>t("div",{children:s.formTitle}))})}),t("div",{children:n!=null&&n.loading?t(y,{size:"small"}):t(ve,{items:e})}),t("div",{className:h.submissionBtn,onClick:()=>Y(e==null?void 0:e._id),children:n!=null&&n.loading?t(y,{size:"small"}):d(p,{children:[t(x,{plain:!0,icon:z.submission}),t("div",{style:{marginTop:"4px"},children:t(L,{variant:"headingXs",as:"h6",color:"subdued",children:"View Submission"})})]})}),t("div",{className:h.submissionBtn,onClick:()=>G(e==null?void 0:e._id),children:n!=null&&n.loading?t(y,{size:"small"}):d(p,{children:[t(x,{plain:!0,icon:z.copy}),t("div",{style:{marginTop:"5px"},children:t(L,{variant:"headingXs",as:"h6",color:"subdued",children:"Copy HTML code"})})]})})]})})}}const Ue=B.memo(Ae);export{Ue as default};
