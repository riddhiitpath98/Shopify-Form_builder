import{v as G,u as H,a as m,m as J,n as K,be as W,bk as Y,b as i,cd as q,S as z,bx as Q,by as X,j as t,e as p,J as b,K as S,aO as Z,U as v,bw as ee,ce as ae,cf as te,cg as ie,ch as oe,ci as re}from"./index-2383bb64.js";import{s as o}from"./FormStyle.module-55a0a2cc.js";/* empty css                              */import{L as x}from"./Link-7fdc7a70.js";import{T as ce}from"./TextField-fb904ada.js";import"./Labelled-f03bba91.js";import"./InlineError-a3b2f636.js";const le=({handleRedirectToForm:u})=>{var B;const c=H(),[n,g]=m.useState({title:"New Form"}),U=J.useAppBridge();K.Fullscreen.create(U),W();const{editFormId:s}=Y(),M=i(e=>e.shopId.shopId),D=i(e=>{var a;return(a=e.viewPort)==null?void 0:a.selectedViewport}),O=i(e=>e.formSetting.validationData.data.validation),j=i(e=>e.formSetting.appearanceData.data.appearance),y=i(e=>e.formSetting.afterSubmitData.data.afterSubmit),N=i(e=>{var a;return(a=e.formSetting.validationData)==null?void 0:a.updatedValidation}),F=i(e=>{var a;return(a=e.formSetting.appearanceData)==null?void 0:a.updatedAppearance}),k=i(e=>{var a;return(a=e.formSetting.afterSubmitData)==null?void 0:a.updatedAfterSubmit}),r=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.inputFields}),I=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.headerFieldData}),w=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.footerFieldData}),A=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.allElementData}),l=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.finalFormData}),C=i(e=>{var a;return(a=e.inputField)==null?void 0:a.isSaveOrUpdate}),$=i(e=>{var a,d,V;return(V=(d=(a=e==null?void 0:e.inputField)==null?void 0:a.editFormData)==null?void 0:d.formData)==null?void 0:V.customForm}),f=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.googelRecaptcha}),h=(B=q($))==null?void 0:B.formTitle;i(e=>e.user.userData.user);const L=(e,a)=>{g({[e]:a})},T=e=>{c(ee(e))},E=m.useMemo(()=>{let e=[];return r.map(a=>{var d;(d=a==null?void 0:a.viewAccess)!=null&&d.includes(z.PREMIUM)&&(e=[...e,a.id])}),e},[r]),P=m.useMemo(()=>{let e=[];return r.map(a=>{a!=null&&a.viewAccess||(e=[...e,a.id])}),e},[r]),R=()=>{const e={shopId:M,hasPremiumInput:E,hasFreeInput:P,enableReCaptcha:(f==null?void 0:f.enable)||!1,customForm:[{formTitle:n.title},{header:I},{element:r},{allElements:A},{footer:w}]};c(ae({combinedObjectArr:e,updatedErrorMsg:N,updatedAppearance:F,updatedAfterSubmit:k}))},_=()=>{const e=[{formTitle:n.title},{header:I},{element:r},{allElements:A},{footer:w}];c(te({_id:s,combinedObjectArr:{customForm:e,hasFreeInput:P,hasPremiumInput:E}})),c(ie({formId:s,validationData:N||O})),c(oe({formId:s,appearanceData:F||j})),c(re({formId:s,afterSubmitData:k||y}))};return m.useEffect(()=>{C&&(c(Q(!1)),c(X(!1)))},[C]),m.useEffect(()=>{h&&g({title:h})},[h]),t("div",{children:p("div",{className:o.topBar,children:[p("div",{className:o.sideBar,children:[t("div",{className:o.logo,onClick:u,children:t(x,{url:"/form",children:t(b,{source:S.backArrow,className:o.leftIcon})})}),t("div",{className:o.backTitle,onClick:u,children:t(x,{url:"/form",children:t("span",{children:"Back to List"})})})]}),t("div",{className:o.rightContext,children:p("div",{className:o.innerContext,children:[t("div",{className:o.formNameWrapper,children:t(ce,{labelHidden:!0,name:"title",placeholder:"Enter Form Name",value:n==null?void 0:n.title,onChange:e=>L("title",e)})}),t("div",{className:o.itemViewPort,children:p("ul",{className:o.viewPortSelector,children:[t("li",{className:`${o.mobileView} ${D==="mobile"?o.ipsTabActive:""}`,onClick:()=>T("mobile"),children:t(b,{source:S.mobile})}),t("li",{className:`${o.desktopView} ${D==="desktop"?o.ipsTabActive:""}`,onClick:()=>T("desktop"),children:t(b,{source:S.desktop})})]})}),t("div",{className:o.itemAction,children:p(Z,{children:[t(v,{onClick:u,children:"Cancel"}),s?t(v,{primary:!0,onClick:_,loading:l==null?void 0:l.loading,disabled:(r==null?void 0:r.length)===0,children:"Update"}):t(v,{primary:!0,onClick:R,loading:l==null?void 0:l.loading,disabled:(r==null?void 0:r.length)===0,children:"Save"})]})})]})})]})})},he=G.memo(le);export{he as default};
