import{a as i,_ as se,u as le,be as re,bk as ne,b as A,d as te,bz as ie,e as q,P as ue,j as l,i as G,q as ce,W as ae,J as de,K as pe,U as z,k as W,bA as me,af as he,bB as fe,bC as Ce}from"./index-2383bb64.js";import{F as be}from"./Form-40b1d8ee.js";import{F as Te,G as c}from"./Grid-100828c6.js";import{T as x}from"./TextField-fb904ada.js";import{S as $}from"./Select-3ba39f1e.js";import"./Labelled-f03bba91.js";import"./InlineError-a3b2f636.js";const Ie="_ipsContactusLayoutContainer_130n3_1",Ae="_ipsContactusSubmissions_130n3_25",Pe="_ipsAPIMapFeildContainer_130n3_37",_e="_ipsAPISupportIcon_130n3_47",k={ipsContactusLayoutContainer:Ie,ipsContactusSubmissions:Ae,ipsAPIMapFeildContainer:Pe,ipsAPISupportIcon:_e},Fe=i.lazy(()=>se(()=>import("./index-9cfce1ac.js"),["assets/index-9cfce1ac.js","assets/index-2383bb64.js","assets/index-ac84de1a.css","assets/index-f5d766a6.css"])),Re=({isEdit:P})=>{const h=le(),y=re(),[d,U]=i.useState([]),[f,C]=i.useState({}),[E,S]=i.useState(!1),[v,V]=i.useState({}),{apiId:a}=ne(),[t,b]=i.useState({apiTitle:"",apiUrl:"",headerRequest:"",inputType:"",method:"",formId:"",shopId:""}),H=()=>{S(!0)},J=()=>{S(!1)},[T,_]=i.useState({}),M=A(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.apiSettingData}),R=A(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.allApiSettingData}),s=A(e=>{var o,r;return(r=(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.editAPISettingsData)==null?void 0:r.data}),w=A(e=>e.shopId.shopId),p=A(e=>{var o,r;return(r=(o=e==null?void 0:e.inputField)==null?void 0:o.finalFormData)==null?void 0:r.formData}),n=A(e=>{var o,r;return(r=(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.editAPISettingsDataByFormId)==null?void 0:r.data}),[ve,L]=i.useState(!1),O=e=>{const o=p.find(r=>r._id===e);if(o){const r=o.customForm.find(u=>u.element);if(r)return r.element}return null};i.useEffect(()=>{h(te(w))},[h,w]),i.useEffect(()=>{P&&a&&h(ie(a))},[P,a]),i.useEffect(()=>{if(P&&a){b({apiTitle:s==null?void 0:s.apiTitle,apiUrl:s==null?void 0:s.apiUrl,headerRequest:s==null?void 0:s.headerRequest,inputType:s==null?void 0:s.inputType,method:s==null?void 0:s.method,formId:s==null?void 0:s.form,shopId:s==null?void 0:s.shopId});const e=O(s==null?void 0:s.form);e&&(U(e),C({...s==null?void 0:s.elementKey}))}},[P,a,s]),i.useEffect(()=>{b({...t,shopId:w,elementKey:f})},[f]);const j=(e,o)=>!e||!o?"This field is required.":"",m=(e,o,r=!1)=>{let u={};if(u={...t,[e]:o},e==="formId"){const F=o;if(a){if(h(me(F)),Object.keys(n).length>0){b({apiTitle:n==null?void 0:n.apiTitle,apiUrl:n==null?void 0:n.apiUrl,headerRequest:n==null?void 0:n.headerRequest,inputType:n==null?void 0:n.inputType,method:n==null?void 0:n.method,formId:n==null?void 0:n.form,shopId:n==null?void 0:n.shopId});const I=O(s==null?void 0:s.form);I&&(U(I),C({...s==null?void 0:s.elementKey}))}}else{const I=O(F);if(I){U(I);let K={};I.forEach(g=>{K[`${g==null?void 0:g.inputId}_${g.id}`]=""}),C({...K})}}}r||_(he(u)),!r&&b({...t,[e]:o}),r&&C({...f,[e]:o}),r&&V({...v,[e]:j(e,o)})},N=[],Q=i.useMemo(()=>(p==null||p.map(e=>{var o;(o=e==null?void 0:e.customForm)==null||o.forEach(r=>{r.formTitle&&N.push({id:e._id,title:r.formTitle})})}),N),[p==null?void 0:p.length]),X=[{label:"Select Form",value:"",disabled:!0},...Q.map(e=>({label:e.title,value:e.id}))],Y=[{label:"Select Type",value:"",disabled:!0},{label:"json",value:"json"}],Z=[{label:"Select Method",value:"",disabled:!0},{label:"GET",value:"get"},{label:"POST",value:"post"}],D=async e=>{let o={},r={...f,...t};if(Object.keys(r).forEach(u=>{const F=j(u,r[u]);F&&(o[u]=F)}),Object.keys(o).length){V({...o,...v}),_({...o});return}h(fe(t)),b({}),C({}),_({}),L(!1),y("/api-settings")},B=()=>{let e={},o={...f,...t};if(Object.keys(o).forEach(r=>{const u=j(r,o[r]);u&&(e[r]=u)}),Object.keys(e).length){V({...e,...v}),_({...e});return}h(Ce({id:a,formValues:t})),b({}),C({}),_({}),L(!1),y("/api-settings")},ee=()=>{L(!1),y("/api-settings")},oe=e=>{P&&a?B():D()};return q(ue,{fullWidth:!0,title:"Add New Contact Form API",primaryAction:{content:"View API List",onAction:()=>ee()},children:[l("div",{children:l(G,{children:l(G.Section,{children:l("div",{className:k.ipsContactusFormLayoutContainer,children:l(ce,{sectioned:!0,children:q(be,{onSubmit:e=>oe(),noValidate:!0,children:[l(Te,{children:q(c,{children:[l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:l(x,{value:t.apiTitle||"",name:"apiUrl",onChange:e=>m("apiTitle",e),label:"Add API title",type:"text",requiredIndicator:!0,error:T.apiTitle,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l($,{label:"Select Contact Form",name:"formId",options:X,onChange:e=>m("formId",e),value:t.formId||"",error:T.formId})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:t.apiUrl||"",name:"apiUrl",onChange:e=>m("apiUrl",e),label:"API Url",type:"text",requiredIndicator:!0,error:T.apiUrl,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:t.headerRequest||"",name:"headerRequest",onChange:e=>m("headerRequest",e),label:"Header Request",type:"headerRequest",multiline:5,requiredIndicator:!0,error:T.headerRequest,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l($,{label:"Input Type",name:"inputType",options:Y,onChange:e=>m("inputType",e),value:t.inputType||"",error:T.inputType})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:l($,{label:"Method",name:"method",options:Z,onChange:e=>m("method",e),value:t.method||"",error:T.method})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:q("div",{className:k.ipsAPIMapFeildContainer,children:[l(ae,{children:"Map your Fields"}),l("div",{className:k.ipsAPISupportIcon,onMouseEnter:H,children:l(de,{source:pe.support,color:"base"})})]})}),d&&(d==null?void 0:d.length)>0?d==null?void 0:d.map(e=>l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:f[`${e.inputId}_${e.id}`]||"",name:`${e.inputId}_${e.id}`,onChange:o=>m(`${e.inputId}_${e.id}`,o,!0),label:e.attributes.label,type:"text",placeholder:"Enter mapping key field name",requiredIndicator:!0,autoComplete:"off",error:v[`${e.inputId}_${e.id}`]})})):null,l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:a?l(z,{primary:!0,submit:!0,loading:R==null?void 0:R.loading,children:"Update"}):l(z,{primary:!0,submit:!0,loading:M==null?void 0:M.loading,children:"Save"})})]})}),l(W,{})]})})})})})}),E&&l(Fe,{open:E,handleClose:J,src:"https://www.contactformtoapi.com/shopify-app-documentation/",title:"Mapping Fields",width:"1000",height:"1000"}),l(W,{})]})};export{Re as default};
