import{R as z,u as G,b as m,n as H,o as K,bf as W,bl as Y,d as i,ce as q,S as J,by as Q,bz as X,j as t,i as p,K as b,N as S,aP as Z,V as v,bx as ee,cf as ae,cg as te,ch as ie,ci as oe,cj as re}from"./index-a7d8285a.js";import{s as o}from"./FormStyle.module-55a0a2cc.js";/* empty css                              */import{L as x}from"./Link-72135556.js";import{T as le}from"./TextField-b45d0d23.js";import"./Labelled-b978b66a.js";import"./InlineError-95e8c5a5.js";const ce=({handleRedirectToForm:u})=>{var V;const l=G(),[n,g]=m.useState({title:"New Form"}),j=H.useAppBridge();K.Fullscreen.create(j),W();const{editFormId:s}=Y(),M=i(e=>e.shopId.shopId),N=i(e=>{var a;return(a=e.viewPort)==null?void 0:a.selectedViewport}),U=i(e=>e.formSetting.validationData.data.validation),y=i(e=>e.formSetting.appearanceData.data.appearance),O=i(e=>e.formSetting.afterSubmitData.data.afterSubmit),D=i(e=>{var a;return(a=e.formSetting.validationData)==null?void 0:a.updatedValidation}),F=i(e=>{var a;return(a=e.formSetting.appearanceData)==null?void 0:a.updatedAppearance}),k=i(e=>{var a;return(a=e.formSetting.afterSubmitData)==null?void 0:a.updatedAfterSubmit}),r=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.inputFields}),I=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.headerFieldData}),A=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.footerFieldData}),C=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.allElementData}),c=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.finalFormData}),w=i(e=>{var a;return(a=e.inputField)==null?void 0:a.isSaveOrUpdate}),$=i(e=>{var a,d,B;return(B=(d=(a=e==null?void 0:e.inputField)==null?void 0:a.editFormData)==null?void 0:d.formData)==null?void 0:B.customForm}),f=i(e=>{var a;return(a=e==null?void 0:e.inputField)==null?void 0:a.googelRecaptcha}),h=(V=q($))==null?void 0:V.formTitle;i(e=>e.user.userData.user);const R=(e,a)=>{g({[e]:a})},T=e=>{l(ee(e))},E=m.useMemo(()=>{let e=[];return r.map(a=>{var d;(d=a==null?void 0:a.viewAccess)!=null&&d.includes(J.PREMIUM)&&(e=[...e,a.id])}),e},[r]),P=m.useMemo(()=>{let e=[];return r.map(a=>{a!=null&&a.viewAccess||(e=[...e,a.id])}),e},[r]),L=()=>{const e={shopId:M,hasPremiumInput:E,hasFreeInput:P,enableReCaptcha:(f==null?void 0:f.enable)||!1,customForm:[{formTitle:n.title},{header:I},{element:r},{allElements:C},{footer:A}]};l(ae({combinedObjectArr:e,updatedErrorMsg:D,updatedAppearance:F,updatedAfterSubmit:k}))},_=()=>{const e=[{formTitle:n.title},{header:I},{element:r},{allElements:C},{footer:A}];l(te({_id:s,combinedObjectArr:{customForm:e,hasFreeInput:P,hasPremiumInput:E}})),l(ie({formId:s,validationData:D||U})),l(oe({formId:s,appearanceData:F||y})),l(re({formId:s,afterSubmitData:k||O}))};return m.useEffect(()=>{w&&(l(Q(!1)),l(X(!1)))},[w]),m.useEffect(()=>{h&&g({title:h})},[h]),t("div",{children:p("div",{className:o.topBar,children:[p("div",{className:o.sideBar,children:[t("div",{className:o.logo,onClick:u,children:t(x,{url:"/form",children:t(b,{source:S.backArrow,className:o.leftIcon})})}),t("div",{className:o.backTitle,onClick:u,children:t(x,{url:"/form",children:t("span",{children:"Back to List"})})})]}),t("div",{className:o.rightContext,children:p("div",{className:o.innerContext,children:[t("div",{className:o.formNameWrapper,children:t(le,{labelHidden:!0,name:"title",placeholder:"Enter Form Name",value:n==null?void 0:n.title,onChange:e=>R("title",e)})}),t("div",{className:o.itemViewPort,children:p("ul",{className:o.viewPortSelector,children:[t("li",{className:`${o.mobileView} ${N==="mobile"?o.ipsTabActive:""}`,onClick:()=>T("mobile"),children:t(b,{source:S.mobile})}),t("li",{className:`${o.desktopView} ${N==="desktop"?o.ipsTabActive:""}`,onClick:()=>T("desktop"),children:t(b,{source:S.desktop})})]})}),t("div",{className:o.itemAction,children:p(Z,{children:[t(v,{onClick:u,children:"Cancel"}),s?t(v,{primary:!0,onClick:_,loading:c==null?void 0:c.loading,disabled:(r==null?void 0:r.length)===0,children:"Update"}):t(v,{primary:!0,onClick:L,loading:c==null?void 0:c.loading,disabled:(r==null?void 0:r.length)===0,children:"Save"})]})})]})})]})})},he=z.memo(ce);export{he as default};
