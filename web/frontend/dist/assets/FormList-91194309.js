import{Q as oe,T as re,R as O,b as l,c as B,n as ae,u as le,o as v,bd as ie,d as S,S as b,h as ce,i as d,F as p,j as t,be as de,P as ue,v as me,l as pe,V as w,N as x,X as z,bf as L,bg as R,bh as he}from"./index-c3d5bec4.js";import"./moment-a9aaa855.js";import{s as h}from"./FormStyle.module-55a0a2cc.js";/* empty css                              */import{u as ge}from"./useElements-3f5e5b7b.js";import{C as fe}from"./index-6a6482ce.js";import{L as Se}from"./Link-50d247fa.js";import{a as be,b as Ee}from"./ResourceList-db353845.js";import{S as Te}from"./Select-b61b0b8e.js";import{S as _e}from"./SkeletonDisplayText-bba52f82.js";import"./index-4bf9a8b5.js";import"./Bleed-3acb4197.js";import"./Checkbox-f34f3496.js";import"./InlineError-24c0ced4.js";import"./TickSmallMinor.svg-a3bf83b5.js";import"./SelectAllActions-1037046a.js";import"./Labelled-61d21849.js";var M={SkeletonThumbnail:"Polaris-SkeletonThumbnail",sizeExtraSmall:"Polaris-SkeletonThumbnail--sizeExtraSmall",sizeSmall:"Polaris-SkeletonThumbnail--sizeSmall",sizeMedium:"Polaris-SkeletonThumbnail--sizeMedium",sizeLarge:"Polaris-SkeletonThumbnail--sizeLarge"};function A({size:i="medium"}){const g=oe(M.SkeletonThumbnail,i&&M[re("size",i)]);return O.createElement("div",{className:g})}const Fe=l.lazy(()=>B(()=>import("./index-af9ce1cd.js"),["assets/index-af9ce1cd.js","assets/index-c3d5bec4.js","assets/index-ac84de1a.css"])),ve=l.lazy(()=>B(()=>import("./index-1ac34380.js"),["assets/index-1ac34380.js","assets/index-c3d5bec4.js","assets/index-ac84de1a.css","assets/index-c45666dd.css"]));function Ae(){var N,k,P;const[i,g]=l.useState("DATE_MODIFIED_DESC"),[V,C]=l.useState([]),[Ce,$]=l.useState(!1),[U,y]=l.useState([]),X=ae.useAppBridge(),E=le(),D=v.Fullscreen.create(X),T=ie(),{elements:j}=ge(),[I,_]=l.useState(!1),c=S(e=>e.shopId.shopId),n=S(e=>{var r;return(r=e==null?void 0:e.inputField)==null?void 0:r.finalFormData}),Y=e=>{T("/submissions",{state:{id:e}})},Q=e=>{var s,m;const r=(m=(s=n.formData)==null?void 0:s.filter)==null?void 0:m.call(s,f=>f._id===e),o=`<div class="form-builder-ips" data-ap-key='${c}' data-key='${r[0].isVisible?e:""}'></div>`;navigator.clipboard.writeText(o).then(function(){L.success("Code Coiped",R)},function(f){L.error(f,R)})},F=S(e=>e.user.userData.subscription),a=S(e=>e.user.userData.user),u=l.useMemo(()=>{var r;const e=(r=n==null?void 0:n.formData)==null?void 0:r.filter(o=>{var s;return(a==null?void 0:a.subscriptionName)===b.FREE&&((s=o==null?void 0:o.hasPremiumInput)==null?void 0:s.length)>0?null:(a.subscriptionName===b.PREMIUM,o)});switch(i){case"DATE_MODIFIED_DESC":return[...e].sort((o,s)=>new Date(s.createdAt).getTime()-new Date(o.createdAt).getTime());case"DATE_MODIFIED_ASC":return[...e].sort((o,s)=>new Date(o.createdAt).getTime()-new Date(s.createdAt).getTime());default:return e}},[n==null?void 0:n.formData,i]),H=e=>{let r=[];C(e),u.filter((o,s)=>e.filter((m,f)=>s==m).length===1).map(o=>r.push(o==null?void 0:o._id)),y(r)},W=e=>{g(e)},q=()=>{_(!0)},G=l.useCallback(()=>{_(!1)},[]),J=()=>{E(he({deleteFormArr:U,shopId:c})),y([]),C([]),_(!1)},K={singular:"form",plural:"forms"},Z=[{label:"Newest update",value:"DATE_MODIFIED_DESC"},{label:"Oldest update",value:"DATE_MODIFIED_ASC"}],ee=[{content:"Delete form",onAction:()=>{q()}}],te=()=>{D.dispatch(v.Fullscreen.Action.ENTER),$(!0),T("/form/new")};l.useEffect(()=>{E(ce(c)),D.dispatch(v.Fullscreen.Action.EXIT)},[E,c]);const ne=(u==null?void 0:u.length)>=((k=(N=F==null?void 0:F.features)==null?void 0:N.form)==null?void 0:k.number_of_forms)&&(a==null?void 0:a.subscriptionName)===b.FREE;return d(p,{children:[(a==null?void 0:a.subscriptionName)===b.FREE?t("div",{className:h.ipsFormPreviewElementBanner,children:t(de,{title:d(p,{children:["You are in Free plan. You can create only 10 forms allowed in your plan. Upgrade to premium to create more forms."," ",t(Se,{url:"/plans",children:t("span",{className:h.premiumPlanLink,children:"Upgrade now."})})]})})}):null,d(ue,{fullWidth:!0,title:"Forms",primaryAction:{content:"Create New Form",onAction:()=>te(),disabled:!!ne},children:[t(me,{children:!c||((P=n==null?void 0:n.formData)==null?void 0:P.length)>0?t(be,{resourceName:K,items:u,renderItem:se,sortValue:i,selectedItems:V,onSelectionChange:H,promotedBulkActions:ee,loading:!c||(n==null?void 0:n.loading),onSortChange:e=>g(e),selectable:!0,alternateTool:t(p,{children:t(Te,{label:"Sort by",labelInline:!0,options:Z,onChange:W,value:i})})}):t(Fe,{})}),I&&t(fe,{active:I,handleClose:G,handleDelete:J,title:"Are you sure to delete selected form(s)?",description:"<p><strong>Note:</strong> Deleting this form will result in the removal of the following:</p>\r <ul>\r <li>The form and its contents.</li>\r <li>API and Logs created for this form.</li>\r </ul>\r <p>Be sure to Export any important data or files related to this form.</p>"}),t(pe,{})]})]});function se(e,r){var o;return e.customForm.map(s=>{s!=null&&s.element&&j(a.subscriptionName,s.element,!0)}),t(Ee,{id:r,name:e==null?void 0:e._id,persistActions:!0,children:d("div",{style:{display:"flex",alignItems:"center"},children:[t("div",{className:h.resouceItemTd,style:{padding:"2rem"},onClick:()=>T(`/form/${e==null?void 0:e._id}`),children:n!=null&&n.loading?t(_e,{size:"medium"}):t("div",{children:(o=e==null?void 0:e.customForm)==null?void 0:o.map((s,m)=>t("div",{children:s.formTitle}))})}),t("div",{children:n!=null&&n.loading?t(A,{size:"small"}):t(ve,{items:e})}),t("div",{className:h.submissionBtn,onClick:()=>Y(e==null?void 0:e._id),children:n!=null&&n.loading?t(A,{size:"small"}):d(p,{children:[t(w,{plain:!0,icon:x.submission}),t("div",{style:{marginTop:"4px"},children:t(z,{variant:"headingXs",as:"h6",color:"subdued",children:"View Submission"})})]})}),t("div",{className:h.submissionBtn,onClick:()=>Q(e==null?void 0:e._id),children:n!=null&&n.loading?t(A,{size:"small"}):d(p,{children:[t(w,{plain:!0,icon:x.copy}),t("div",{style:{marginTop:"5px"},children:t(z,{variant:"headingXs",as:"h6",color:"subdued",children:"Copy HTML code"})})]})})]})})}}const Xe=O.memo(Ae);export{Xe as default};
