import{a as l,_ as oe,u as te,b9 as se,be as re,b as g,d as ne,bt as le,e as A,P as ie,j as t,i as G,p as ae,T as ce,I as ue,G as de,O as K,k as z,ac as pe,b6 as me,bu as he}from"./index-885978b8.js";import{F as fe}from"./Form-0bf7b800.js";import{F as Ie,G as a}from"./Grid-d9bc9914.js";import{T as P}from"./TextField-2c415d65.js";import{S as O}from"./Select-6d584da8.js";import"./Labelled-5b2a4701.js";import"./InlineError-71d6bf79.js";const Ce="_ipsContactusLayoutContainer_130n3_1",be="_ipsContactusSubmissions_130n3_25",Fe="_ipsAPIMapFeildContainer_130n3_37",ge="_ipsAPISupportIcon_130n3_47",U={ipsContactusLayoutContainer:Ce,ipsContactusSubmissions:be,ipsAPIMapFeildContainer:Fe,ipsAPISupportIcon:ge},Te=l.lazy(()=>oe(()=>import("./index-91b7ecc3.js"),["assets/index-91b7ecc3.js","assets/index-885978b8.js","assets/index-ac84de1a.css","assets/index-f5d766a6.css"])),Ve=({isEdit:f})=>{const I=te(),y=se(),[u,R]=l.useState([]),[m,C]=l.useState({}),[$,j]=l.useState(!1),[T,S]=l.useState({}),{apiId:c}=re(),[n,b]=l.useState({apiTitle:"",apiUrl:"",headerRequest:"",inputType:"",method:"",formId:"",shopId:""}),H=()=>{j(!0)},W=()=>{j(!1)},[h,F]=l.useState({}),v=g(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.apiSettingData}),x=g(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.allApiSettingData}),s=g(e=>{var o,r;return(r=(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.editAPISettingsData)==null?void 0:r.data}),q=g(e=>e.shopId.shopId),d=g(e=>{var o,r;return(r=(o=e==null?void 0:e.inputField)==null?void 0:o.finalFormData)==null?void 0:r.formData}),[_e,V]=l.useState(!1),E=e=>{const o=d.find(r=>r._id===e);if(o){const r=o.customForm.find(i=>i.element);if(r)return r.element}return null};l.useEffect(()=>{I(ne(q))},[I,q]),l.useEffect(()=>{f&&c&&I(le(c))},[f,c]),l.useEffect(()=>{if(f&&c){b({apiTitle:s==null?void 0:s.apiTitle,apiUrl:s==null?void 0:s.apiUrl,headerRequest:s==null?void 0:s.headerRequest,inputType:s==null?void 0:s.inputType,method:s==null?void 0:s.method,formId:s==null?void 0:s.form,shopId:s==null?void 0:s.shopId});const e=E(s==null?void 0:s.form);e&&(R(e),C({...s==null?void 0:s.elementKey}))}},[f,c,s]),l.useEffect(()=>{b({...n,shopId:q,elementKey:m})},[m]);const M=(e,o)=>!e||!o?"This field is required.":"",p=(e,o,r=!1)=>{let i={};if(i={...n,[e]:o},e==="formId"){const L=E(o);if(L){R(L);let N={};L.forEach(_=>{N[`${_==null?void 0:_.inputId}_${_.id}`]=""}),C({...N})}}r||F(pe(i)),!r&&b({...n,[e]:o}),r&&C({...m,[e]:o}),r&&S({...T,[e]:M(e,o)})},k=[],J=l.useMemo(()=>(d==null||d.map(e=>{var o;(o=e==null?void 0:e.customForm)==null||o.forEach(r=>{r.formTitle&&k.push({id:e._id,title:r.formTitle})})}),k),[d==null?void 0:d.length]),Q=[{label:"Select Form",value:"",disabled:!0},...J.map(e=>({label:e.title,value:e.id}))],X=[{label:"Select Type",value:"",disabled:!0},{label:"json",value:"json"}],Y=[{label:"Select Method",value:"",disabled:!0},{label:"GET",value:"get"},{label:"POST",value:"post"}],Z=async e=>{let o={},r={...m,...n};if(Object.keys(r).forEach(i=>{const w=M(i,r[i]);w&&(o[i]=w)}),Object.keys(o).length){S({...o,...T}),F({...o});return}I(me(n)),b({}),C({}),F({}),V(!1),y("/api-settings")},D=()=>{let e={},o={...m,...n};if(Object.keys(o).forEach(r=>{const i=M(r,o[r]);i&&(e[r]=i)}),Object.keys(e).length){S({...e,...T}),F({...e});return}I(he({id:c,formValues:n})),b({}),C({}),F({}),V(!1),y("/api-settings")},B=()=>{V(!1),y("/api-settings")},ee=e=>{f&&c?D():Z()};return A(ie,{fullWidth:!0,title:"Add New Contact Form API",primaryAction:{content:"View API List",onAction:()=>B()},children:[t("div",{children:t(G,{children:t(G.Section,{children:t("div",{className:U.ipsContactusFormLayoutContainer,children:t(ae,{sectioned:!0,children:A(fe,{onSubmit:e=>ee(),noValidate:!0,children:[t(Ie,{children:A(a,{children:[t(a.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:t(P,{value:n.apiTitle||"",name:"apiUrl",onChange:e=>p("apiTitle",e),label:"Add API title",type:"text",requiredIndicator:!0,error:h.apiTitle,autoComplete:"off"})}),t(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:t(O,{label:"Select Contact Form",name:"formId",options:Q,onChange:e=>p("formId",e),value:n.formId||"",error:h.formId})}),t(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:t(P,{value:n.apiUrl||"",name:"apiUrl",onChange:e=>p("apiUrl",e),label:"API Url",type:"text",requiredIndicator:!0,error:h.apiUrl,autoComplete:"off"})}),t(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:t(P,{value:n.headerRequest||"",name:"headerRequest",onChange:e=>p("headerRequest",e),label:"Header Request",type:"headerRequest",multiline:5,requiredIndicator:!0,error:h.headerRequest,autoComplete:"off"})}),t(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:t(O,{label:"Input Type",name:"inputType",options:X,onChange:e=>p("inputType",e),value:n.inputType||"",error:h.inputType})}),t(a.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:t(O,{label:"Method",name:"method",options:Y,onChange:e=>p("method",e),value:n.method||"",error:h.method})}),t(a.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:A("div",{className:U.ipsAPIMapFeildContainer,children:[t(ce,{children:"Map your Fields"}),t("div",{className:U.ipsAPISupportIcon,onMouseEnter:H,children:t(ue,{source:de.support,color:"base"})})]})}),u&&(u==null?void 0:u.length)>0?u==null?void 0:u.map(e=>t(a.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:t(P,{value:m[`${e.inputId}_${e.id}`]||"",name:`${e.inputId}_${e.id}`,onChange:o=>p(`${e.inputId}_${e.id}`,o,!0),label:e.attributes.label,type:"text",placeholder:"Enter mapping key field name",requiredIndicator:!0,autoComplete:"off",error:T[`${e.inputId}_${e.id}`]})})):null,t(a.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:c?t(K,{primary:!0,submit:!0,loading:x==null?void 0:x.loading,children:"Update"}):t(K,{primary:!0,submit:!0,loading:v==null?void 0:v.loading,children:"Save"})})]})}),t(z,{})]})})})})})}),$&&t(Te,{open:$,handleClose:W,src:"https://www.contactformtoapi.com/mapping-fields/",title:"Mapping Fields",width:"1000",height:"1000"}),t(z,{})]})};export{Ve as default};
