import{a,_ as j,u as w,b as c,d as B,bx as z,e as f,j as l,T as J,P as U,F as m,p as V,O as W}from"./index-885978b8.js";import{h as q}from"./moment-fbc5633a.js";import{u as G,I as t}from"./IndexTable-87a14fe3.js";import{E as H}from"./SelectAllActions-1ff4a4a3.js";import"./set-root-property-5afc98ee.js";import"./Checkbox-c617239d.js";import"./InlineError-71d6bf79.js";import"./TickSmallMinor.svg-d264ec46.js";const K=a.lazy(()=>j(()=>import("./ModalLogs-2e8f46a5.js"),["assets/ModalLogs-2e8f46a5.js","assets/index-885978b8.js","assets/index-ac84de1a.css","assets/ExceptionList-6576e897.js","assets/ModalLogs-6d900bcf.css"])),ln=()=>{var N,A;const i=w(),[g,I]=a.useState(!1),[P,y]=a.useState({}),d=c(n=>{var o;return(o=n==null?void 0:n.shopId)==null?void 0:o.shopId}),x=c(n=>{var o,r;return(r=(o=n==null?void 0:n.anyAPISetting)==null?void 0:o.allApiLogsData)==null?void 0:r.data}),M=c(n=>{var o,r;return(r=(o=n==null?void 0:n.anyAPISetting)==null?void 0:o.allApiLogsData)==null?void 0:r.total_count}),T=10,[s,v]=a.useState(1),e=c(n=>{var o;return(o=n==null?void 0:n.anyAPISetting)==null?void 0:o.allApiLogsData}),u=c(n=>{var o,r;return(r=(o=n==null?void 0:n.inputField)==null?void 0:o.finalFormData)==null?void 0:r.formData}),h=c(n=>{var o;return(o=n==null?void 0:n.anyAPISetting)==null?void 0:o.allApiSettingData}),E={singular:"log",plural:"logs"},{selectedResources:_,allResourcesSelected:F,handleSelectionChange:L}=G(e==null?void 0:e.data);a.useEffect(()=>{i(B(d))},[i,d]),a.useEffect(()=>{i(z({shopId:d,page:s,per_page:T}))},[i,s,d]);function S(n){var r;const o=u==null?void 0:u.find(p=>p._id===n);return o?(r=o==null?void 0:o.customForm[0])==null?void 0:r.formTitle:"Form not found"}function C(n){var r;const o=(r=h==null?void 0:h.data)==null?void 0:r.find(p=>p._id===n);return o?o==null?void 0:o.apiTitle:"API Title not found"}const b=n=>{y(n),I(!0)},R=a.useCallback(()=>{I(!1),y({})},[]),D=async()=>{v(s+1)},k=!d||(e==null?void 0:e.loading),O=l(m,{children:k?null:l(H,{title:"No logs found",description:"Try changing the filters or search term",withIllustration:!0})}),Y=(e==null?void 0:e.data)&&((N=e==null?void 0:e.data)==null?void 0:N.map((n,o)=>f(t.Row,{id:n==null?void 0:n._id,selected:_.includes(n==null?void 0:n._id),onClick:()=>b(n),position:o,children:[l(t.Cell,{children:l("a",{className:"Polaris-Link Polaris-Link--monochrome Polaris-Link--removeUnderline",href:"#","data-primary-link":!0,"data-polaris-unstyled":!0,children:l(J,{variation:"strong",children:S(n==null?void 0:n.formId)})})}),l(t.Cell,{children:C(n==null?void 0:n.apiId)}),l(t.Cell,{className:"ips-custom-cell",children:JSON.stringify(n==null?void 0:n.log)}),l(t.Cell,{children:q(n==null?void 0:n.createdAt).format("YYYY-MM-DD")})]},n==null?void 0:n._id)));return f(U,{fullWidth:!0,title:"Logs",children:[l(m,{children:f(V,{children:[l(t,{resourceName:E,loading:k,itemCount:((A=e==null?void 0:e.data)==null?void 0:A.length)||0,emptyState:O,selectedItemsCount:F?"All":_.length,onSelectionChange:L,selectable:!1,headings:[{title:"Form Name"},{title:"API Name"},{title:"Log"},{title:"Created Date"}],children:Y}),x.length<M?l("div",{className:"ips-pagination_button",children:l(W,{primary:!0,onClick:D,children:"Load More"})}):null]})}),g&&l(K,{item:P&&P,open:g,formData:u,handleClose:R,findAPINameById:C,findFormNameById:S})]})};export{ln as default};
