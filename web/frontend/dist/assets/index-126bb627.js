import{b as i,c as se,u as le,bf as re,bl as ne,d as A,h as te,bA as ie,i as q,P as ue,j as l,L as G,v as ce,X as ae,K as de,N as me,V as z,l as H,bB as pe,ag as he,bC as fe,bD as Ce}from"./index-a7d8285a.js";import{F as be}from"./Form-cf8b986c.js";import{F as Te,G as c}from"./Grid-31a96f57.js";import{T as x}from"./TextField-b45d0d23.js";import{S as $}from"./Select-2f2ac977.js";import"./Labelled-b978b66a.js";import"./InlineError-95e8c5a5.js";const Ie="_ipsContactusLayoutContainer_130n3_1",Ae="_ipsContactusSubmissions_130n3_25",Pe="_ipsAPIMapFeildContainer_130n3_37",_e="_ipsAPISupportIcon_130n3_47",E={ipsContactusLayoutContainer:Ie,ipsContactusSubmissions:Ae,ipsAPIMapFeildContainer:Pe,ipsAPISupportIcon:_e},Fe=i.lazy(()=>se(()=>import("./index-1353ecfc.js"),["assets/index-1353ecfc.js","assets/index-a7d8285a.js","assets/index-ac84de1a.css","assets/index-f5d766a6.css"])),Me=({isEdit:P})=>{const h=le(),y=re(),[d,V]=i.useState([]),[f,C]=i.useState({}),[S,k]=i.useState(!1),[g,U]=i.useState({}),{apiId:a}=ne(),[t,b]=i.useState({apiTitle:"",apiUrl:"",headerRequest:"",inputType:"",method:"",formId:"",shopId:""}),W=()=>{k(!0)},X=()=>{k(!1)},[T,_]=i.useState({}),L=A(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.apiSettingData}),M=A(e=>{var o;return(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.allApiSettingData}),s=A(e=>{var o,r;return(r=(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.editAPISettingsData)==null?void 0:r.data}),R=A(e=>e.shopId.shopId),m=A(e=>{var o,r;return(r=(o=e==null?void 0:e.inputField)==null?void 0:o.finalFormData)==null?void 0:r.formData}),n=A(e=>{var o,r;return(r=(o=e==null?void 0:e.anyAPISetting)==null?void 0:o.editAPISettingsDataByFormId)==null?void 0:r.data}),[ge,w]=i.useState(!1),O=e=>{const o=m.find(r=>r._id===e);if(o){const r=o.customForm.find(u=>u.element);if(r)return r.element}return null};i.useEffect(()=>{h(te(R))},[h,R]),i.useEffect(()=>{P&&a&&h(ie(a))},[P,a]),i.useEffect(()=>{if(P&&a){b({apiTitle:s==null?void 0:s.apiTitle,apiUrl:s==null?void 0:s.apiUrl,headerRequest:s==null?void 0:s.headerRequest,inputType:s==null?void 0:s.inputType,method:s==null?void 0:s.method,formId:s==null?void 0:s.form,shopId:s==null?void 0:s.shopId});const e=O(s==null?void 0:s.form);e&&(V(e),C({...s==null?void 0:s.elementKey}))}},[P,a,s]),i.useEffect(()=>{b({...t,shopId:R,elementKey:f})},[f]);const j=(e,o)=>!e||!o?"This field is required.":"",p=(e,o,r=!1)=>{let u={};if(u={...t,[e]:o},e==="formId"){const F=o;if(a){if(h(pe(F)),Object.keys(n).length>0){b({apiTitle:n==null?void 0:n.apiTitle,apiUrl:n==null?void 0:n.apiUrl,headerRequest:n==null?void 0:n.headerRequest,inputType:n==null?void 0:n.inputType,method:n==null?void 0:n.method,formId:n==null?void 0:n.form,shopId:n==null?void 0:n.shopId});const I=O(s==null?void 0:s.form);I&&(V(I),C({...s==null?void 0:s.elementKey}))}}else{const I=O(F);if(I){V(I);let K={};I.forEach(v=>{K[`${v==null?void 0:v.inputId}_${v.id}`]=""}),C({...K})}}}r||_(he(u)),!r&&b({...t,[e]:o}),r&&C({...f,[e]:o}),r&&U({...g,[e]:j(e,o)})},N=[],J=i.useMemo(()=>(m==null||m.map(e=>{var o;(o=e==null?void 0:e.customForm)==null||o.forEach(r=>{r.formTitle&&N.push({id:e._id,title:r.formTitle})})}),N),[m==null?void 0:m.length]),Q=[{label:"Select Form",value:"",disabled:!0},...J.map(e=>({label:e.title,value:e.id}))],Y=[{label:"Select Type",value:"",disabled:!0},{label:"json",value:"json"}],Z=[{label:"Select Method",value:"",disabled:!0},{label:"GET",value:"get"},{label:"POST",value:"post"}],D=async e=>{let o={},r={...f,...t};if(Object.keys(r).forEach(u=>{const F=j(u,r[u]);F&&(o[u]=F)}),Object.keys(o).length){U({...o,...g}),_({...o});return}h(fe(t)),b({}),C({}),_({}),w(!1),y("/api-settings")},B=()=>{let e={},o={...f,...t};if(Object.keys(o).forEach(r=>{const u=j(r,o[r]);u&&(e[r]=u)}),Object.keys(e).length){U({...e,...g}),_({...e});return}h(Ce({id:a,formValues:t})),b({}),C({}),_({}),w(!1),y("/api-settings")},ee=()=>{w(!1),y("/api-settings")},oe=e=>{P&&a?B():D()};return q(ue,{fullWidth:!0,title:"Add New Contact Form API",primaryAction:{content:"View API List",onAction:()=>ee()},children:[l("div",{children:l(G,{children:l(G.Section,{children:l("div",{className:E.ipsContactusFormLayoutContainer,children:l(ce,{sectioned:!0,children:q(be,{onSubmit:e=>oe(),noValidate:!0,children:[l(Te,{children:q(c,{children:[l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:l(x,{value:t.apiTitle||"",name:"apiUrl",onChange:e=>p("apiTitle",e),label:"Add API title",type:"text",requiredIndicator:!0,error:T.apiTitle,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l($,{label:"Select Contact Form",name:"formId",options:Q,onChange:e=>p("formId",e),value:t.formId||"",error:T.formId})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:t.apiUrl||"",name:"apiUrl",onChange:e=>p("apiUrl",e),label:"API Url",type:"text",requiredIndicator:!0,error:T.apiUrl,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:t.headerRequest||"",name:"headerRequest",onChange:e=>p("headerRequest",e),label:"Header Request",type:"headerRequest",multiline:5,requiredIndicator:!0,error:T.headerRequest,autoComplete:"off"})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l($,{label:"Input Type",name:"inputType",options:Y,onChange:e=>p("inputType",e),value:t.inputType||"",error:T.inputType})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:l($,{label:"Method",name:"method",options:Z,onChange:e=>p("method",e),value:t.method||"",error:T.method})}),l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:q("div",{className:E.ipsAPIMapFeildContainer,children:[l(ae,{children:"Map your Fields"}),l("div",{className:E.ipsAPISupportIcon,onMouseEnter:W,children:l(de,{source:me.support,color:"base"})})]})}),d&&(d==null?void 0:d.length)>0?d==null?void 0:d.map(e=>l(c.Cell,{columnSpan:{xs:6,sm:6,md:6,lg:6},children:l(x,{value:f[`${e.inputId}_${e.id}`]||"",name:`${e.inputId}_${e.id}`,onChange:o=>p(`${e.inputId}_${e.id}`,o,!0),label:e.attributes.label,type:"text",placeholder:"Enter mapping key field name",requiredIndicator:!0,autoComplete:"off",error:g[`${e.inputId}_${e.id}`]})})):null,l(c.Cell,{columnSpan:{xs:6,sm:6,md:12,lg:12},children:a?l(z,{primary:!0,submit:!0,loading:M==null?void 0:M.loading,children:"Update"}):l(z,{primary:!0,submit:!0,loading:L==null?void 0:L.loading,children:"Save"})})]})}),l(H,{})]})})})})})}),S&&l(Fe,{open:S,handleClose:X,src:"https://www.contactformtoapi.com/mapping-fields/",title:"Mapping Fields",width:"1000",height:"1000"}),l(H,{})]})};export{Me as default};
