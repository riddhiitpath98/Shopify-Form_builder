var nt=Object.defineProperty;var at=(i,e,t)=>e in i?nt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var ie=(i,e,t)=>(at(i,typeof e!="symbol"?e+"":e,t),t);import{v as A,a as h,O as _,j as s,T as ot,av as lt,e as v,F as X,a3 as ct,U as O,aw as dt,W as J,N as qe,ax as ut,J as xe,a0 as Me,a5 as je,ay as Ie,a2 as ht,a1 as pt,a7 as mt,a9 as ft,az as Ft,a6 as gt,Y as Ue,Z as Qe,ab as Ct,aA as yt,aB as bt,aC as Le,aD as vt,X as St,aE as kt,aF as E,M as De,K as _t,b as Z,aG as Rt,u as At,aH as Oe,aI as Bt,aJ as Pt,d as Tt,P as xt,q as Mt,S as It,k as Nt,aK as K,aL as Y,aM as Et}from"./index-cdbbdef1.js";import{h as Lt}from"./moment-fbc5633a.js";import{C as Dt}from"./index-8f8c825c.js";import{E as Ot,D as $t}from"./ExceptionList-9d613a38.js";import{R as Ht,a as wt,b as Wt}from"./ResourceList-2508f881.js";import{S as qt}from"./Select-a4816d0f.js";import{T as jt}from"./TextField-a28bba39.js";import{C as $e}from"./ChoiceList-1e1b7efa.js";import"./index-f1ff8313.js";import"./Bleed-a317419e.js";import"./Checkbox-a1799219.js";import"./InlineError-fe270c03.js";import"./TickSmallMinor.svg-3b3bc779.js";import"./SelectAllActions-c4a9dcba.js";import"./Labelled-c5d2484a.js";var Ut=function(e){return A.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),A.createElement("path",{d:"M10 14a.997.997 0 0 1-.707-.293l-5-5a.999.999 0 1 1 1.414-1.414l4.293 4.293 4.293-4.293a.999.999 0 1 1 1.414 1.414l-5 5a.997.997 0 0 1-.707.293z"}))},Qt=function(e){return A.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),A.createElement("path",{d:"M15 13a.997.997 0 0 1-.707-.293l-4.293-4.293-4.293 4.293a.999.999 0 1 1-1.414-1.414l5-5a.999.999 0 0 1 1.414 0l5 5a.999.999 0 0 1-.707 1.707z"}))},Vt=function(e){return A.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),A.createElement("path",{d:"M8 12a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm9.707 4.293-4.82-4.82a5.968 5.968 0 0 0 1.113-3.473 6 6 0 0 0-12 0 6 6 0 0 0 6 6 5.968 5.968 0 0 0 3.473-1.113l4.82 4.82a.997.997 0 0 0 1.414 0 .999.999 0 0 0 0-1.414z"}))},Pe={Collapsible:"Polaris-Collapsible",isFullyClosed:"Polaris-Collapsible--isFullyClosed",expandOnPrint:"Polaris-Collapsible--expandOnPrint"};function zt({id:i,expandOnPrint:e,open:t,transition:n=!0,preventMeasuringOnChildrenUpdate:a,children:d,onAnimationEnd:o}){const[f,m]=h.useState(0),[u,p]=h.useState(t),[y,g]=h.useState("idle"),R=h.useRef(null),$=y==="idle"&&t&&u,H=y==="idle"&&!t&&!u,w=e||!H?d:null,B=_(Pe.Collapsible,H&&Pe.isFullyClosed,e&&Pe.expandOnPrint),U=Yt(n),C={...typeof n=="object"&&{transitionDuration:n.duration,transitionTimingFunction:n.timingFunction},maxHeight:$?"none":`${f}px`,overflow:$?"visible":"hidden"},S=h.useCallback(({target:P})=>{P===R.current&&(g("idle"),p(t),o&&o())},[o,t]),ee=h.useCallback(()=>{U?(p(t),g("idle"),t&&R.current?m(R.current.scrollHeight):m(0)):g("measuring")},[t,U]);return h.useEffect(()=>{t!==u&&ee()},[t,u]),h.useEffect(()=>{!t||!R.current||m(R.current.scrollHeight)},[]),h.useEffect(()=>{if(R.current)switch(y){case"idle":break;case"measuring":m(R.current.scrollHeight),g("animating");break;case"animating":m(t?R.current.scrollHeight:0)}},[y,t,u]),s("div",{id:i,style:C,ref:R,className:B,onTransitionEnd:S,"aria-hidden":!t,children:w})}const Kt=/^0(ms|s)$/;function Yt(i){if(typeof i=="boolean")return!i;const{duration:e}=i;return!!(e&&Kt.test(e.trim()))}var k={Filters:"Polaris-Filters",FiltersContainer:"Polaris-Filters__FiltersContainer",FiltersContainerHeader:"Polaris-Filters__FiltersContainerHeader",FiltersDesktopContainerContent:"Polaris-Filters__FiltersDesktopContainerContent",FiltersMobileContainerContent:"Polaris-Filters__FiltersMobileContainerContent",FiltersContainerFooter:"Polaris-Filters__FiltersContainerFooter",FiltersMobileContainerFooter:"Polaris-Filters__FiltersMobileContainerFooter",EmptyFooterState:"Polaris-Filters__EmptyFooterState",FilterTriggerContainer:"Polaris-Filters__FilterTriggerContainer",FilterTrigger:"Polaris-Filters__FilterTrigger",FilterTriggerTitle:"Polaris-Filters__FilterTriggerTitle",AppliedFilterBadgeContainer:"Polaris-Filters__AppliedFilterBadgeContainer",open:"Polaris-Filters--open",FilterTriggerLabelContainer:"Polaris-Filters__FilterTriggerLabelContainer",first:"Polaris-Filters--first",last:"Polaris-Filters--last",FilterNodeContainer:"Polaris-Filters__FilterNodeContainer",SearchIcon:"Polaris-Filters__SearchIcon",Backdrop:"Polaris-Filters__Backdrop",HelpText:"Polaris-Filters__HelpText",TagsContainer:"Polaris-Filters__TagsContainer"},I={ConnectedFilterControl:"Polaris-Filters-ConnectedFilterControl",CenterContainer:"Polaris-Filters-ConnectedFilterControl__CenterContainer",right:"Polaris-Filters-ConnectedFilterControl--right",Item:"Polaris-Filters-ConnectedFilterControl__Item","Item-focused":"Polaris-Filters-ConnectedFilterControl__Item--focused",ProxyButtonContainer:"Polaris-Filters-ConnectedFilterControl__ProxyButtonContainer",RightContainer:"Polaris-Filters-ConnectedFilterControl__RightContainer",MoreFiltersButtonContainer:"Polaris-Filters-ConnectedFilterControl__MoreFiltersButtonContainer",queryFieldHidden:"Polaris-Filters-ConnectedFilterControl--queryFieldHidden",RightContainerWithoutMoreFilters:"Polaris-Filters-ConnectedFilterControl__RightContainerWithoutMoreFilters",onlyButtonVisible:"Polaris-Filters-ConnectedFilterControl--onlyButtonVisible",Wrapper:"Polaris-Filters-ConnectedFilterControl__Wrapper",AuxiliaryContainer:"Polaris-Filters-ConnectedFilterControl__AuxiliaryContainer"};function Te({children:i}){const{value:e,setTrue:t,setFalse:n}=ot(!1),a=_(I.Item,e&&I["Item-focused"]);return A.createElement("div",{onBlur:n,onFocus:t,className:a},i)}const Jt=150;class Gt extends h.Component{constructor(...e){super(...e),this.state={availableWidth:0,proxyButtonsWidth:{}},this.container=h.createRef(),this.proxyButtonContainer=h.createRef(),this.moreFiltersButtonContainer=h.createRef(),this.handleResize=lt(()=>{this.measureProxyButtons(),this.measureAvailableWidth()},40,{leading:!0,trailing:!0,maxWait:40})}componentDidMount(){this.handleResize()}render(){const{children:e,rightPopoverableActions:t,rightAction:n,auxiliary:a,forceShowMorefiltersButton:d=!0,queryFieldHidden:o}=this.props,f=t!=null?this.getActionsToRender(t):[],m=_(I.ConnectedFilterControl,t&&I.right),u=d||t&&t.length!==f.length,p=_(I.RightContainer,!u&&I.RightContainerWithoutMoreFilters,o&&I.queryFieldHidden),y=f.length>0?s("div",{className:p,children:this.popoverFrom(f)}):null,g=_(I.MoreFiltersButtonContainer,f.length===0&&I.onlyButtonVisible),R=n?s("div",{ref:this.moreFiltersButtonContainer,className:g,children:u&&s(Te,{children:n})}):null,$=t?s("div",{className:I.ProxyButtonContainer,ref:this.proxyButtonContainer,"aria-hidden":!0,children:t.map(w=>s("div",{"data-key":w.key,children:this.activatorButtonFrom(w,{proxy:!0})},w.key))}):null,H=a?s("div",{className:I.AuxiliaryContainer,children:a}):null;return v(X,{children:[$,v("div",{className:I.Wrapper,children:[v("div",{className:m,ref:this.container,children:[e?s("div",{className:I.CenterContainer,children:s(Te,{children:e})}):null,y,R,s(ct,{event:"resize",handler:this.handleResize})]}),H]})]})}measureProxyButtons(){if(this.proxyButtonContainer.current){const e={};this.proxyButtonContainer.current&&Array.from(this.proxyButtonContainer.current.children).forEach(n=>{const a=n.getBoundingClientRect().width+78,d=n instanceof HTMLElement&&n.dataset.key;d&&(e[d]=a)}),this.setState({proxyButtonsWidth:e})}}measureAvailableWidth(){if(this.container.current&&this.moreFiltersButtonContainer.current){const e=this.container.current.getBoundingClientRect().width,t=this.moreFiltersButtonContainer.current.getBoundingClientRect().width,n=0,a=this.props.queryFieldHidden?0:Jt,d=e-a-t-n;this.setState({availableWidth:d})}}getActionsToRender(e){let t=this.state.availableWidth;const n=[];for(let a=0;t>0&&a<e.length;a++){const d=e[a],o=this.state.proxyButtonsWidth[d.key];if(o<=t)n.push(d),t-=o;else break}return n}activatorButtonFrom(e,t){const n=t!=null&&t.proxy?void 0:`Activator-${e.key}`;return s(O,{onClick:e.onAction,disclosure:!0,disabled:this.props.disabled||e.disabled,id:n,children:e.content})}popoverFrom(e){return e.map(t=>s(Te,{children:s(dt,{active:t.popoverOpen,activator:this.activatorButtonFrom(t),onClose:t.onAction,preferredAlignment:"left",sectioned:!0,children:t.popoverContent})},t.key))}}function Zt({children:i,hidden:e}){return e?A.createElement(J,{as:"span",visuallyHidden:!0},i):A.createElement(A.Fragment,null,i)}var L={Tag:"Polaris-Tag",disabled:"Polaris-Tag--disabled",clickable:"Polaris-Tag--clickable",removable:"Polaris-Tag--removable",linkable:"Polaris-Tag--linkable",TagText:"Polaris-Tag__TagText",Button:"Polaris-Tag__Button",segmented:"Polaris-Tag--segmented",Link:"Polaris-Tag__Link",LinkText:"Polaris-Tag__LinkText"};function Xt({children:i,disabled:e=!1,onClick:t,onRemove:n,accessibilityLabel:a,url:d}){const o=qe(),f=n&&d,m=_(L.Tag,e&&L.disabled,t&&L.clickable,n&&L.removable,d&&!e&&L.linkable,f&&L.segmented);if(t)return A.createElement("button",{type:"button",disabled:e,className:m,onClick:t},i);let u=a;u||(u=typeof i=="string"?i:void 0);const p=o.translate("Polaris.Tag.ariaLabel",{children:u||""}),y=n?A.createElement("button",{type:"button","aria-label":p,className:_(L.Button,f&&L.segmented),onClick:n,onMouseUp:ut,disabled:e},A.createElement(xe,{source:Me})):null,g=d&&!e?A.createElement("a",{className:_(L.Link,f&&L.segmented),href:d},A.createElement("span",{title:u,className:L.LinkText},i)):A.createElement("span",{title:u,className:L.TagText},i);return A.createElement("span",{className:m},g,y)}var M={Sheet:"Polaris-Sheet",Container:"Polaris-Sheet__Container",Bottom:"Polaris-Sheet__Bottom",enterBottom:"Polaris-Sheet--enterBottom",enterBottomActive:"Polaris-Sheet--enterBottomActive",exitBottom:"Polaris-Sheet--exitBottom",exitBottomActive:"Polaris-Sheet--exitBottomActive",Right:"Polaris-Sheet__Right",enterRight:"Polaris-Sheet--enterRight",enterRightActive:"Polaris-Sheet--enterRightActive",exitRight:"Polaris-Sheet--exitRight",exitRightActive:"Polaris-Sheet--exitRightActive"};const er={enter:_(M.Bottom,M.enterBottom),enterActive:_(M.Bottom,M.enterBottomActive),exit:_(M.Bottom,M.exitBottom),exitActive:_(M.Bottom,M.exitBottomActive)},tr={enter:_(M.Right,M.enterRight),enterActive:_(M.Right,M.enterRightActive),exit:_(M.Right,M.exitRight),exitActive:_(M.Right,M.exitRightActive)};function He({children:i,open:e,onClose:t,onEntered:n,onExit:a,accessibilityLabel:d,activator:o}){const{isNavigationCollapsed:f}=je(),m=h.useRef(null),u=h.useRef(null),p=h.useCallback(()=>{t();const g=o&&we(o)?o&&o.current:u.current;g&&requestAnimationFrame(()=>Ie(g))},[o,t]);h.useEffect(()=>{},[]);const y=o&&!we(o)?s("div",{ref:u,children:o}):null;return v(X,{children:[y,v(ht,{idPrefix:"sheet",children:[s(pt,{nodeRef:m,classNames:f?er:tr,timeout:parseInt(mt["duration-300"],10),in:e,mountOnEnter:!0,unmountOnExit:!0,onEntered:n,onExit:a,children:s("div",{...Object.assign({className:M.Container},ft.props,Ft.props,{ref:m}),children:s(gt,{trapping:e,children:s("div",{role:"dialog","aria-modal":!0,tabIndex:-1,className:M.Sheet,"aria-label":d,children:i})})})}),s(Ue,{keyCode:Qe.Escape,handler:p}),e&&s(Ct,{transparent:!0,onClick:p})]})]})}function we(i){return Object.prototype.hasOwnProperty.call(i,"current")}var W;(function(i){i.Filter="Filter",i.Shortcut="Shortcut"})(W||(W={}));class Ve extends h.Component{constructor(...e){super(...e),this.context=void 0,this.state={open:!1,readyForFocus:!1},this.moreFiltersButtonContainer=h.createRef(),this.moreFiltersDoneButtonContainer=h.createRef(),this.focusNode=h.createRef(),this.closeFilters=()=>{this.setState({open:!1},()=>{this.moreFiltersButtonContainer.current&&Ie(this.moreFiltersButtonContainer.current,!1)})},this.toggleFilters=()=>{this.state.open===!0?this.closeFilters():this.openFilters()},this.setReadyForFocus=t=>()=>{this.setState({readyForFocus:t})},this.handleClearAll=()=>{this.props.onClearAll(),this.moreFiltersDoneButtonContainer.current&&Ie(this.moreFiltersDoneButtonContainer.current,!1)}}render(){const{filters:e,queryValue:t,onQueryBlur:n,onQueryChange:a,onQueryFocus:d,focused:o,onClearAll:f,appliedFilters:m,onQueryClear:u,queryPlaceholder:p,children:y,disabled:g=!1,helpText:R,hideTags:$,hideQueryField:H,disableQueryField:w=!1,i18n:B,mediaQuery:{isNavigationCollapsed:U}}=this.props,{resourceName:l}=this.context,{open:C,readyForFocus:S}=this.state,ee=C?v(X,{children:[s(yt,{}),s("div",{className:k.Backdrop,onClick:this.closeFilters})]}):null,P=e.map((x,ce)=>{const V=this.state[`${x.key}${W.Filter}`]===!0,ve=V?Qt:Ut,Se=_(k.FilterTriggerContainer,V&&k.open,ce===0&&k.first,e.length!==1&&ce===e.length-1&&k.last),de=this.getAppliedFilterContent(x.key),ke=de?s("div",{className:k.AppliedFilterBadgeContainer,children:s(kt,{status:"new",children:de})}):null,ue=`${x.key}Collapsible`,_e=_(k.FilterTrigger);return v("div",{className:Se,children:[v("button",{onClick:()=>this.toggleFilter(x.key),className:_e,id:`${x.key}ToggleButton`,type:"button","aria-controls":ue,"aria-expanded":V,children:[v("div",{className:k.FilterTriggerLabelContainer,children:[s("h3",{className:k.FilterTriggerTitle,children:s(J,{as:"span",color:this.props.disabled||x.disabled?"subdued":void 0,children:x.label})}),s("span",{className:k.FilterTriggerIcon,children:s(xe,{source:ve,color:"base"})})]}),ke]}),s(zt,{id:ue,open:V,onAnimationEnd:this.setReadyForFocus(!0),children:s("div",{className:k.FilterNodeContainer,children:s(bt,{disabled:!V||!S||!C,root:this.focusNode,children:this.generateFilterMarkup(x)})})})]},x.key)}),q=m?m.length:0,Q=$&&q>0?B.translate("Polaris.Filters.moreFiltersWithCount",{count:q}):B.translate("Polaris.Filters.moreFilters"),T=e.length?s("div",{ref:this.moreFiltersButtonContainer,children:s(O,{onClick:this.toggleFilters,disabled:g,children:Q})}):null,ae=l||{singular:B.translate("Polaris.ResourceList.defaultItemSingular"),plural:B.translate("Polaris.ResourceList.defaultItemPlural")},j=this.transformFilters(e),me=s(Gt,{rightPopoverableActions:j,rightAction:T,auxiliary:y,disabled:g,forceShowMorefiltersButton:e.length>j.length,queryFieldHidden:H,children:H?null:s(jt,{placeholder:p||B.translate("Polaris.Filters.filter",{resourceName:ae.plural}),onChange:a,onBlur:n,onFocus:d,value:t,focused:o,label:p||B.translate("Polaris.Filters.filter",{resourceName:ae.plural}),labelHidden:!0,prefix:s("span",{className:k.SearchIcon,children:s(xe,{source:Vt})}),clearButton:!0,onClearButtonClick:u,disabled:g||w,autoComplete:"off"})}),oe=_(k.FiltersContainerHeader),D=v("div",{className:oe,children:[s(J,{variant:"headingLg",as:"h3",children:Q}),s(O,{icon:Me,plain:!0,accessibilityLabel:B.translate("Polaris.Filters.cancel"),onClick:this.closeFilters})]}),fe=v("div",{className:oe,children:[s(O,{icon:Me,plain:!0,accessibilityLabel:B.translate("Polaris.Filters.cancel"),onClick:this.closeFilters}),s(J,{variant:"headingLg",as:"h3",children:Q}),s(O,{onClick:this.closeFilters,primary:!0,children:B.translate("Polaris.Filters.done")})]}),te=_(k.FiltersContainerFooter),Fe=v("div",{className:te,children:[s(O,{onClick:this.handleClearAll,disabled:!this.hasAppliedFilters(),children:B.translate("Polaris.Filters.clearAllFilters")}),s("div",{ref:this.moreFiltersDoneButtonContainer,children:s(O,{onClick:this.closeFilters,primary:!0,children:B.translate("Polaris.Filters.done")})})]}),le=s("div",{className:k.FiltersMobileContainerFooter,children:this.hasAppliedFilters()?s(O,{onClick:f,fullWidth:!0,children:B.translate("Polaris.Filters.clearAllFilters")}):s("div",{className:k.EmptyFooterState,children:s(J,{color:"subdued",as:"span",children:s("p",{children:B.translate("Polaris.Filters.noFiltersApplied")})})})}),ge=!m||m.length<1,Ce=$?null:s(Zt,{hidden:ge,children:s("div",{className:k.TagsContainer,"aria-live":"polite",children:(m||[]).map(x=>s(Xt,{onRemove:()=>{x.onRemove(x.key)},disabled:g,children:x.label},x.key))})}),re=_(k.FiltersMobileContainerContent),ye=_(k.FiltersDesktopContainerContent),G=U?v(He,{accessibilityLabel:Q,open:C,onClose:this.closeFilters,onEntered:this.setReadyForFocus(!0),onExit:this.setReadyForFocus(!1),children:[fe,v(Le,{className:re,shadow:!0,children:[P,le]})]}):s(He,{accessibilityLabel:Q,open:C,onClose:this.closeFilters,onEntered:this.setReadyForFocus(!0),onExit:this.setReadyForFocus(!1),children:v("div",{className:k.FiltersContainer,children:[D,s(Le,{className:ye,shadow:!0,children:P}),Fe]})}),be=R?s("div",{id:"FiltersHelpText",className:k.HelpText,children:s(J,{color:"subdued",as:"span",children:R})}):null;return s(vt.Provider,{value:!0,children:v("div",{className:k.Filters,children:[me,G,Ce,be,ee,s(Ue,{keyCode:Qe.Escape,handler:this.closeFilters})]})})}hasAppliedFilters(){const{appliedFilters:e,queryValue:t}=this.props;return!!(e&&e.length>0)||!!(t&&t!=="")}getAppliedFilterContent(e){const{appliedFilters:t}=this.props;if(!t)return;const n=t.find(a=>a.key===e);return n==null?void 0:n.label}getAppliedFilterRemoveHandler(e){const{appliedFilters:t}=this.props;if(!t)return;const n=t.find(a=>a.key===e);return n==null?void 0:n.onRemove}openFilters(){this.setState({open:!0})}toggleFilter(e){this.state[`${e}${W.Filter}`]===!0?this.setState({readyForFocus:!1,[`${e}${W.Filter}`]:!1}):this.setState({readyForFocus:!1,[`${e}${W.Filter}`]:!0})}openFilterShortcut(e){this.setState({[`${e}${W.Shortcut}`]:!0})}closeFilterShortcut(e){this.setState({[`${e}${W.Shortcut}`]:!1})}toggleFilterShortcut(e){this.state[`${e}${W.Shortcut}`]===!0?this.closeFilterShortcut(e):this.openFilterShortcut(e)}transformFilters(e){const t=[];return rr(e).forEach(n=>{const{key:a,label:d,disabled:o}=n;t.push({popoverContent:this.generateFilterMarkup(n),popoverOpen:!!this.state[`${a}${W.Shortcut}`],key:a,content:d,disabled:o,onAction:()=>this.toggleFilterShortcut(a)})}),t}generateFilterMarkup(e){const t=this.props.i18n,n=this.getAppliedFilterRemoveHandler(e.key),a=n==null?void 0:()=>{n(e.key)},d=!e.hideClearButton&&s(O,{plain:!0,disabled:a==null,onClick:a,accessibilityLabel:t.translate("Polaris.Filters.clearLabel",{filterName:e.label}),children:t.translate("Polaris.Filters.clear")});return s("div",{ref:this.focusNode,children:v(St,{vertical:!0,spacing:"tight",children:[e.filter,d]})})}}Ve.contextType=Ht;function rr(i){return i.filter(e=>e.shortcut===!0)}function sr(i){const e=qe(),t=je();return s(Ve,{...Object.assign({},i,{i18n:e,mediaQuery:t})})}const ir=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),ze=i=>Array.isArray(i)&&i.every(e=>typeof e=="object"&&!(e instanceof Array)),nr=i=>Array.isArray(i)&&i.every(e=>Array.isArray(e)),ar=i=>Array.from(i.map(e=>Object.keys(e)).reduce((e,t)=>new Set([...e,...t]),[])),or=(i,e)=>{e=e||ar(i);let t=e,n=e;ze(e)&&(t=e.map(d=>d.label),n=e.map(d=>d.key));const a=i.map(d=>n.map(o=>lr(o,d)));return[t,...a]},lr=(i,e)=>{const t=i.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(n,a,d,o){const f=n[a];if(f==null)o.splice(1);else return f},e);return t===void 0?i in e?e[i]:"":t},cr=i=>typeof i>"u"||i===null?"":i,Ke=(i,e=",",t='"')=>i.filter(n=>n).map(n=>n.map(a=>cr(a)).map(a=>`${t}${a}${t}`).join(e)).join(`
`),dr=(i,e,t,n)=>Ke(e?[e,...i]:i,t,n),ur=(i,e,t,n)=>Ke(or(i,e),t,n),hr=(i,e,t,n)=>e?`${e.join(t)}
${i}`:i.replace(/"/g,'""'),Ye=(i,e,t,n)=>{if(ze(i))return ur(i,e,t,n);if(nr(i))return dr(i,e,t,n);if(typeof i=="string")return hr(i,e,t);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},Je=(i,e,t,n,a)=>{const d=Ye(i,t,n,a),o=ir()?"application/csv":"text/csv",f=new Blob([e?"\uFEFF":"",d],{type:o}),m=`data:${o};charset=utf-8,${e?"\uFEFF":""}${d}`,u=window.URL||window.webkitURL;return typeof u.createObjectURL>"u"?m:u.createObjectURL(f)},Ge={data:E.oneOfType([E.string,E.array,E.func]).isRequired,headers:E.array,target:E.string,separator:E.string,filename:E.string,uFEFF:E.bool,onClick:E.func,asyncOnClick:E.bool,enclosingCharacter:E.string},Ze={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},pr={target:"_blank"};class We extends A.Component{constructor(e){super(e),this.state={}}buildURI(){return Je(...arguments)}componentDidMount(){const{data:e,headers:t,separator:n,enclosingCharacter:a,uFEFF:d,target:o,specs:f,replace:m}=this.props;this.state.page=window.open(this.buildURI(e,d,t,n,a),o,f,m)}getWindow(){return this.state.page}render(){return null}}ie(We,"defaultProps",Object.assign(Ze,pr)),ie(We,"propTypes",Ge);var pe;let mr=(pe=class extends A.Component{constructor(e){super(e),this.buildURI=this.buildURI.bind(this)}buildURI(){return Je(...arguments)}handleLegacy(e,t=!1){if(window.navigator.msSaveOrOpenBlob){e.preventDefault();const{data:n,headers:a,separator:d,filename:o,enclosingCharacter:f,uFEFF:m}=this.props,u=t&&typeof n=="function"?n():n;let p=new Blob([m?"\uFEFF":"",Ye(u,a,d,f)]);return window.navigator.msSaveBlob(p,o),!1}}handleAsyncClick(e){const t=n=>{if(n===!1){e.preventDefault();return}this.handleLegacy(e,!0)};this.props.onClick(e,t)}handleSyncClick(e){if(this.props.onClick(e)===!1){e.preventDefault();return}this.handleLegacy(e)}handleClick(){return e=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(e):this.handleSyncClick(e);this.handleLegacy(e)}}render(){const{data:e,headers:t,separator:n,filename:a,uFEFF:d,children:o,onClick:f,asyncOnClick:m,enclosingCharacter:u,...p}=this.props,g=typeof window>"u"?"":this.buildURI(e,d,t,n,u);return s("a",{download:a,...p,ref:R=>this.link=R,target:"_self",href:g,onClick:this.handleClick(),children:o})}},ie(pe,"defaultProps",Ze),ie(pe,"propTypes",Ge),pe);const fr=mr,Fr="_ipsSubmissionModalHead_1tnr7_1",gr="_resourceItem_1tnr7_13",Cr="_dateTimeItem_1tnr7_25",yr="_isReadElement_1tnr7_33",br="_ipsPaginationButton_1tnr7_39",ne={ipsSubmissionModalHead:Fr,resourceItem:gr,dateTimeItem:Cr,isReadElement:yr,ipsPaginationButton:br};const vr=({open:i,handleClose:e,item:t,formData:n,handleIsReadStatus:a})=>{const d=h.useMemo(()=>{var m;const f=n.find(u=>(u==null?void 0:u._id)===(t==null?void 0:t.form));return f?(m=f.customForm[0])==null?void 0:m.formTitle:""},[]),o=h.useMemo(()=>{const f={};return n.forEach((m,u)=>{m.customForm.forEach(p=>{p.element&&p.element.forEach(y=>{m._id===(t==null?void 0:t.form)&&(f[y.inputId]=y.attributes.label||(y==null?void 0:y.title))})})}),f},[]);return s(De,{instant:!0,open:i,onClose:e,title:"Submission Details",secondaryActions:[{content:"Close",onAction:e},{content:"Mark as unread",onAction:()=>a(t._id)}],children:s(De.Section,{children:v("div",{children:[s("div",{className:ne.ipsSubmissionModalHead,children:s(Ot,{items:[{icon:_t.form,description:`Form -  ${d}`}]})}),s($t,{items:Object.entries(t==null?void 0:t.submission[0]).filter(([f,m])=>{const u=f.split("_").pop();return!["hidden","paragraph","heading","html"].includes(u)}).map(([f,m])=>{var y;const u=f==="file"?"File":o[f.match(/[a-zA-Z0-9]+/)[0]];let p=m;return typeof p=="boolean"&&(p=p.toString()),p===""&&(p="-"),u==="Checkboxes"&&(Array.isArray(p)?p=p==null?void 0:p.map(g=>g.value).join(","):p=(y=JSON.parse(p))==null?void 0:y.map(g=>g.value).join(",")),Array.isArray(p)&&(p=(p==null?void 0:p.length)>0?p==null?void 0:p.map((g,R)=>s("div",{children:u==="File"?s("a",{href:`https://shopifyappapi.project-demo.info:3008${g}`,target:"_blank",rel:"noopener noreferrer",children:g}):g.value},R)):" - "),{term:s("div",{dangerouslySetInnerHTML:{__html:(u==null?void 0:u.charAt(0).toUpperCase())+(u==null?void 0:u.slice(1))}}),description:p}})})]})})})};function Sr(){var Ne,Ee;const[i,e]=h.useState([]),[t,n]=h.useState("-createdAt"),[a,d]=h.useState([]),[o,f]=h.useState([]),[m,u]=h.useState(""),[p,y]=h.useState({}),[g,R]=h.useState([]),[$,H]=h.useState(!1),[w,B]=h.useState(!1),U=Z(r=>r.user.userData.user),l=Rt(),C=At(),[S,ee]=h.useState(1),P=Z(r=>{var c;return(c=r==null?void 0:r.shopId)==null?void 0:c.shopId}),q=Z(r=>r.submission.submissionData.data),Q=Z(r=>r.submission.submissionData.total_count),T=10,ae=Z(r=>r.submission.submissionData),j=Z(r=>{var c,F;return(F=(c=r==null?void 0:r.inputField)==null?void 0:c.finalFormData)==null?void 0:F.formData}),me=async()=>{ee(S+1)},oe=`export_submission_${new Date().toISOString().slice(0,10)}.csv`,D=h.useMemo(()=>q==null?void 0:q.filter((c,F)=>{const b=c==null?void 0:c.submission[0];if(b){const N=Object.entries(b);for(const[he,z]of N)if(typeof z=="string"&&(z!=null&&z.toLowerCase().includes(m==null?void 0:m.toLowerCase())))return c}}),[q,m]);h.useMemo(()=>{let r={};const c=j.find(F=>{var b;return F._id===((b=l==null?void 0:l.state)==null?void 0:b.id)});return c&&(r.id=c._id,r.formTitle=c.customForm[0].formTitle,f([r.id])),r},[]);const fe=h.useMemo(()=>{const r=[];if(D!=null&&D.length){let c={};D==null||D.map((F,b)=>{let N=F.submission[0];for(const he in N){let z=he.split("_").pop().toUpperCase(),se=N[he];Array.isArray(se)&&(se=z==="FILE"?se.map(Be=>Be.name).join(", "):se.map(Be=>Be.value).join(", ")),c={...c,[z]:se}}r.push({No:b+1,...c})})}return r},[D]),te=h.useMemo(()=>{const r=[];return j==null||j.map(c=>{var F;(F=c==null?void 0:c.customForm)==null||F.forEach(b=>{b.formTitle&&r.push({id:c._id,title:b.formTitle})})}),r},[j.length]),Fe=r=>{y(r),C(Oe({_id:r._id,isRead:!0})),H(!0)},le=h.useCallback(()=>{H(!1),y({})},[]),ge=h.useCallback(r=>{C(Oe({_id:r,isRead:!1})),y({}),le()},[]),Ce=r=>{var c,F,b,N;r&&r[0]==="read"?((c=l==null?void 0:l.state)!=null&&c.id?C(K({filterFormId:(F=l==null?void 0:l.state)==null?void 0:F.id,path:t,query:{isRead:!0,formId:o,page:S,per_page:T}})):C(Y({path:t,query:{isRead:!0,formId:o,page:S,per_page:T},shopId:P})),d(r)):r&&r[0]==="unread"&&((b=l==null?void 0:l.state)!=null&&b.id?C(K({filterFormId:(N=l==null?void 0:l.state)==null?void 0:N.id,path:t,query:{isRead:!1,formId:o,page:S,per_page:T}})):C(Y({path:t,query:{isRead:!1,formId:o,page:S,per_page:T},shopId:P})),d(r))},re=()=>{var r,c;(r=l==null?void 0:l.state)!=null&&r.id?C(K({filterFormId:(c=l==null?void 0:l.state)==null?void 0:c.id,path:t,query:{isRead:"",formId:o,page:S,per_page:T}})):C(Y({path:t,query:{isRead:"",formId:o,page:S,per_page:T},shopId:P})),d([])},ye=r=>{var c,F;r&&((c=l==null?void 0:l.state)!=null&&c.id?C(K({filterFormId:(F=l==null?void 0:l.state)==null?void 0:F.id,path:t,query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:r,page:S,per_page:T}})):C(Y({path:t,query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:r,page:S,per_page:T},shopId:P})),f(r))},G=()=>{var r,c;(r=l==null?void 0:l.state)!=null&&r.id?C(K({filterFormId:(c=l==null?void 0:l.state)==null?void 0:c.id,path:t,query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:[],page:S,per_page:T}})):C(Y({path:t,query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:[],page:S,per_page:T},shopId:P})),f([])},be=h.useCallback(r=>u(r),[]),x=h.useCallback(()=>u(""),[]),ce=h.useCallback(()=>{re(),G(),x()},[x,re,G]),V=r=>{let c=[];e(r),q.filter((F,b)=>r.filter((N,he)=>b==N).length===1).map(F=>c.push(F==null?void 0:F._id)),R(c)};h.useEffect(()=>{var r,c;C((r=l.state)!=null&&r.id?Bt({order:t,id:(c=l.state)==null?void 0:c.id,page:S,per_page:T}):Pt({order:t,query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:o,page:S,per_page:T},shopId:P}))},[C,(Ne=l==null?void 0:l.state)==null?void 0:Ne.id,S,P]),h.useEffect(()=>{C(Tt(P))},[P]);const ve=()=>{B(!0)},Se=h.useCallback(()=>{B(!1)},[]),de=()=>{var r;C(Et({filterFormId:(r=l==null?void 0:l.state)==null?void 0:r.id,submissionIdArr:g,path:t,query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:o},shopId:P})),R([]),e([]),B(!1)},ke={singular:"submission",plural:"submissions"},ue=[{label:"Newest",value:"-createdAt"},{label:"Oldest",value:"createdAt"}],_e=[{content:"Delete submissions",onAction:()=>{ve()}}],Xe=te.map(r=>({label:r.title,value:r.id})),et=[{key:"status",label:"Status",filter:s($e,{title:"Status",titleHidden:!0,choices:[{label:"Read",value:"read"},{label:"Unread",value:"unread"}],selected:a||[],onChange:Ce}),shortcut:!0},{key:"form",label:"Form",filter:s($e,{title:"Form",titleHidden:!0,choices:Xe,selected:o||[],onChange:ye,allowMultiple:!0}),shortcut:!0}],Re=[];if(o&&o.length>0){const r=o.map(c=>{const F=te.find(b=>b.id===c);return F?F.title:""});Re.push({key:"formStatus",label:`Form : ${r.join(", ")}`,onRemove:G})}const Ae=[];if(a&&!it(a)&&Ae.push({key:"status",label:`Status ${a}`,onRemove:re}),o&&o.length>0){const r=o.map(c=>{const F=te.find(b=>b.id===c);return F?F.title:""});Ae.push({key:"formStatus",label:`Form : ${r.join(", ")}`,onRemove:G})}const tt=r=>{var c,F,b,N;r==="createdAt"?((c=l==null?void 0:l.state)!=null&&c.id?C(K({filterFormId:(F=l==null?void 0:l.state)==null?void 0:F.id,path:"createdAt",query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:o,page:S,per_page:T}})):C(Y({path:"createdAt",query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:o,page:S,per_page:T},shopId:P})),n(r)):((b=l==null?void 0:l.state)!=null&&b.id?C(K({filterFormId:(N=l==null?void 0:l.state)==null?void 0:N.id,path:"-createdAt",query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:o,page:S,per_page:T}})):C(Y({path:"-createdAt",query:{isRead:a[0]==="read"?!0:a[0]==="unread"?!1:"",formId:o,page:S,per_page:T},shopId:P})),n(r))},rt=s(sr,{queryValue:m,filters:et,appliedFilters:Ae,onQueryChange:be,onQueryClear:x,onClearAll:ce});return s(X,{children:v(xt,{fullWidth:!0,title:"Submissions",children:[Re.length>0?s(J,{variant:"headingSm",as:"h6",children:s("div",{style:{marginBottom:"6px"},children:(Ee=Re[0])==null?void 0:Ee.label})}):null,v(Mt,{children:[s(wt,{resourceName:ke,items:D.length>0?D:[],renderItem:st,sortValue:t,selectedItems:i,onSelectionChange:V,promotedBulkActions:_e,loading:!P||ae.loading,onSortChange:r=>n(r),selectable:!0,alternateTool:v(X,{children:[(U==null?void 0:U.subscriptionName)===It.PREMIUM?s(fr,{style:{marginRight:"5px"},data:fe,filename:oe,children:s(O,{primary:!0,children:"Export All Data"})}):null,s(qt,{label:"Sort by",labelInline:!0,options:ue,onChange:tt,value:t})]}),filterControl:rt}),q.length<Q?s("div",{className:ne.ipsPaginationButton,children:s(O,{primary:!0,onClick:me,children:"Load More"})}):null]}),s(Nt,{})]})});function st(r,c){return v(X,{children:[s("div",{className:`${r!=null&&r.isRead?"":ne.isReadElement}`,children:s(Wt,{id:c,name:r==null?void 0:r._id,onClick:()=>Fe(r),persistActions:!0,children:v("div",{style:{display:"flex",alignItems:"center"},children:[Object.entries(r==null?void 0:r.submission[0]).filter(([F])=>["text","email","name","textarea","phone"].includes(F.split("_").pop())).map(([F,b])=>s("div",{className:ne.resourceItem,children:b},F)),s("div",{className:ne.dateTimeItem,children:Lt(r==null?void 0:r.createdAt).format("YYYY-MM-DD HH:mm:ss")})]})})}),$&&s(vr,{item:p&&p,open:$,formData:j,handleClose:le,handleIsReadStatus:ge}),w&&s(Dt,{active:w,handleClose:Se,handleDelete:de,title:"Are you sure to delete selected submission(s)?",description:"This action cannot be undone. No way to revert the deleted data."})]})}function it(r){return Array.isArray(r)?r.length===0:r===""||r==null}}const wr=A.memo(Sr);export{wr as default};
